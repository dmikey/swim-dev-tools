!function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){(function(e){"use strict";var t=n(10),i={},r={table:[]};onmessage=function(n){var o=JSON.parse(n.data);if("downlink"===o.action){var s,p,a,a;!function(){var t=function(e,t){if(e.dispatchAction=t,e.index=o.index,e.body)for(var n=0;n<e.body.length;n++)for(var i in e.body[n])e.body[n].hasOwnProperty(i)&&(e[i]=e.body[n][i]);postMessage(JSON.stringify(e)),r.table.push(e)};if(s=i[o.host]||e.downlink().host(o.host),i[o.host]=s,o.node instanceof Array)for(p=0;p<o.node.length;p++)a=s[o.node[p]+o.lane]||s.node(o.node[p]),a.lane(o.lane).onEvent(function(){o.event&&t(msg,o.event)}).onSync(function(e){o.sync&&t(e,o.sync)}).sync(),s[o.node[p]+o.lane]=a;else a=s[o.node+o.lane]||s.node(o.node),a.lane(o.lane).onEvent(function(e){o.event&&t(e,o.event)}).onSync(function(e){o.sync&&t(e,o.sync)}).sync(),s[o.node+o.lane]=a}()}if("unlink"==o.action,"query"===o.action){var u=t(o.query,{data:r});u.dispatchAction=o.dispatchAction,postMessage(JSON.stringify(u))}}}).call(t,n(1))},function(e,t,n){(function(t){"use strict";function i(e){e=e||{},Object.defineProperty(this,"options",{value:e,enumerable:!0}),Object.defineProperty(this,"channels",{value:{},configurable:!0}),Object.defineProperty(this,"delegate",{value:this,enumerable:!0,writable:!0})}function r(e){Object.defineProperty(this,"channel",{value:e}),Object.defineProperty(this,"downlinks",{value:[],configurable:!0}),Object.defineProperty(this,"delegate",{value:this,enumerable:!0,writable:!0}),e.registerDelegate(this)}function o(e,t){r.call(this,e),Object.defineProperty(this,"hostUri",{value:t,enumerable:!0}),Object.defineProperty(this,"downlinks",{value:[],configurable:!0})}function s(e,t,n){r.call(this,e),Object.defineProperty(this,"hostUri",{value:t,enumerable:!0}),Object.defineProperty(this,"nodeUri",{value:n,enumerable:!0}),Object.defineProperty(this,"downlinks",{value:[],configurable:!0})}function p(e,t,n,i){r.call(this,e),Object.defineProperty(this,"hostUri",{value:t,enumerable:!0}),Object.defineProperty(this,"nodeUri",{value:n,enumerable:!0}),Object.defineProperty(this,"laneUri",{value:i,enumerable:!0}),Object.defineProperty(this,"downlinks",{value:[],configurable:!0})}function a(e,t,n){n=n||{},Object.defineProperty(this,"client",{value:e,configurable:!0}),Object.defineProperty(this,"hostUri",{value:t,enumerable:!0}),Object.defineProperty(this,"options",{value:n,enumerable:!0}),Object.defineProperty(this,"credentials",{value:n.credentials,writable:!0}),Object.defineProperty(this,"isAuthorized",{value:!1,enumerable:!0,writable:!0}),Object.defineProperty(this,"session",{value:null,enumerable:!0,writable:!0}),Object.defineProperty(this,"uriCache",{value:new b(t),configurable:!0}),Object.defineProperty(this,"delegates",{value:[],configurable:!0}),Object.defineProperty(this,"downlinks",{value:{},configurable:!0}),Object.defineProperty(this,"sendBuffer",{value:[],configurable:!0}),Object.defineProperty(this,"reconnectTimer",{value:null,writable:!0}),Object.defineProperty(this,"reconnectTimeout",{value:0,writable:!0}),Object.defineProperty(this,"idleTimer",{value:null,writable:!0}),Object.defineProperty(this,"socket",{value:null,writable:!0})}function u(e,t,n){a.call(this,e,t,n)}function h(e,t,n){a.call(this,e,t,n),Object.defineProperty(this,"channelId",{value:null,writable:!0}),Object.defineProperty(this,"parser",{value:null,writable:!0}),Object.defineProperty(this,"offset",{value:0,writable:!0}),Object.defineProperty(this,"sendTimer",{value:null,writable:!0})}function l(e,t,n){w.StringIterator.call(this,e,t,n)}function c(e,t){Object.defineProperty(this,"channel",{value:e,configurable:!0}),Object.defineProperty(this,"scope",{value:t,configurable:!0}),Object.defineProperty(this,"proxy",{value:{},configurable:!0}),this.options={}}function f(e,t,n,i,r){r=r||{},Object.defineProperty(this,"channel",{value:e}),Object.defineProperty(this,"hostUri",{value:t,enumerable:!0}),Object.defineProperty(this,"nodeUri",{value:n,enumerable:!0}),Object.defineProperty(this,"laneUri",{value:i,enumerable:!0}),Object.defineProperty(this,"options",{value:r,enumerable:!0}),Object.defineProperty(this,"delegate",{value:r.delegate||this,enumerable:!0,writable:!0})}function d(e,t,n,i,r){f.call(this,e,t,n,i,r)}function y(e,t,n,i,r){f.call(this,e,t,n,i,r)}function v(e,t,n,i,r){y.call(this,e,t,n,i,r),Object.defineProperty(this,"state",{value:[],configurable:!0})}function m(e,t,n,i,r){y.call(this,e,t,n,i,r),Object.defineProperty(this,"state",{value:[],configurable:!0}),Object.defineProperty(this,"table",{value:{},configurable:!0}),this.primaryKey=m.primaryKeyOption(this.options),this.sortBy=m.sortByOption(this.options)}function b(e,t){t=t||32,Object.defineProperty(this,"baseUri",{value:e,enumerable:!0}),Object.defineProperty(this,"base",{value:w.uri.parse(e)}),Object.defineProperty(this,"size",{value:t,enumerable:!0}),Object.defineProperty(this,"resolveCache",{value:new Array(t)}),Object.defineProperty(this,"unresolveCache",{value:new Array(t)})}var g=n(2),w=t.recon||n(3),E=n(5),k=t.WebSocket||n(7).w3cwebsocket;Object.defineProperty(i.prototype,"onChannelConnect",{value:function(e){"function"==typeof this.delegate.onConnect&&this.onConnect(e)},configurable:!0}),Object.defineProperty(i.prototype,"onChannelDisconnect",{value:function(e){"function"==typeof this.delegate.onDisconnect&&this.onDisconnect(e)},configurable:!0}),Object.defineProperty(i.prototype,"onChannelError",{value:function(e){"function"==typeof this.delegate.onError&&this.onError(e)},configurable:!0}),Object.defineProperty(i.prototype,"onChannelAuthorize",{value:function(e){"function"==typeof this.delegate.onAuthorize&&this.onAuthorize(e)},configurable:!0}),Object.defineProperty(i.prototype,"onChannelDeauthorize",{value:function(e){"function"==typeof this.delegate.onDeauthorize&&this.onDeauthorize(e)},configurable:!0}),Object.defineProperty(i.prototype,"callChannelWithLinkArgs",{value:function(e,t){var n,r,o,s;2===t.length?(s={},o=t[1],r=t[0],n=i.extractHostUri(r)):3===t.length?"object"==typeof t[2]?(s=t[2],o=t[1],r=t[0],n=i.extractHostUri(r)):(n=t[0],r=i.resolveNodeUri(n,t[1]),o=t[2],s={}):(n=t[0],r=i.resolveNodeUri(n,t[1]),o=t[2],s=t[3]);var p=this.getOrCreateChannel(n);return p[e](r,o,s)},configurable:!0}),i.prototype.getOrCreateChannel=function(e){var t=this.channels[e];return void 0===t&&(t=this.options.noWebSocket||/^http/.test(e)?new h(this,e,this.options):new u(this,e,this.options),this.channels[e]=t),t},i.prototype.authorize=function(e,t){var n=this.getOrCreateChannel(e);n.authorize(t)},i.prototype.downlink=function(){return new c(null,this)},i.prototype.link=function(){return this.callChannelWithLinkArgs("link",arguments)},i.prototype.sync=function(){return this.callChannelWithLinkArgs("sync",arguments)},i.prototype.syncList=function(){return this.callChannelWithLinkArgs("syncList",arguments)},i.prototype.syncMap=function(){return this.callChannelWithLinkArgs("syncMap",arguments)},i.prototype.command=function(){var e,t,n,r;3===arguments.length?(r=arguments[2],n=arguments[1],t=arguments[0],e=i.extractHostUri(t)):(e=arguments[0],t=i.resolveNodeUri(e,arguments[1]),n=arguments[2],r=arguments[3]);var o=this.getOrCreateChannel(e);o.command(t,n,r)},i.prototype.host=function(e){var t=this.getOrCreateChannel(e);return new o(t,e)},i.prototype.node=function(){var e,t;1===arguments.length?(t=arguments[0],e=i.extractHostUri(t)):(e=arguments[0],t=i.resolveNodeUri(e,arguments[1]));var n=this.getOrCreateChannel(e);return new s(n,e,t)},i.prototype.lane=function(){var e,t,n;2===arguments.length?(n=arguments[1],t=arguments[0],e=i.extractHostUri(t)):(e=arguments[0],t=i.resolveNodeUri(e,arguments[1]),n=arguments[2]);var r=this.getOrCreateChannel(e);return new p(r,e,t,n)},i.prototype.close=function(){var e=this.channels;Object.defineProperty(this,"channels",{value:{},configurable:!0});for(var t in e){var n=e[t];n.close()}},i.extractHostUri=function(e){var t=w.uri.parse(e),n=t.scheme;return"swim"===n?n="ws":"swims"===n&&(n="wss"),w.uri.stringify({scheme:n,authority:t.authority})},i.resolveNodeUri=function(e,t){return w.uri.stringify(w.uri.resolve(e,t))},Object.defineProperty(r.prototype,"isConnected",{get:function(){return this.channel.isConnected},enumerable:!0}),Object.defineProperty(r.prototype,"isAuthorized",{get:function(){return this.channel.isAuthorized},enumerable:!0}),Object.defineProperty(r.prototype,"session",{get:function(){return this.channel.session},enumerable:!0}),Object.defineProperty(r.prototype,"onChannelConnect",{value:function(e){"function"==typeof this.delegate.onConnect&&this.onConnect(e)},configurable:!0}),Object.defineProperty(r.prototype,"onChannelDisconnect",{value:function(e){"function"==typeof this.delegate.onDisconnect&&this.onDisconnect(e)},configurable:!0}),Object.defineProperty(r.prototype,"onChannelError",{value:function(e){"function"==typeof this.delegate.onError&&this.onError(e)},configurable:!0}),Object.defineProperty(r.prototype,"onChannelAuthorize",{value:function(e){"function"==typeof this.delegate.onAuthorize&&this.onAuthorize(e)},configurable:!0}),Object.defineProperty(r.prototype,"onChannelDeauthorize",{value:function(e){"function"==typeof this.delegate.onDeauthorize&&this.onDeauthorize(e)},configurable:!0}),r.prototype.registerDownlink=function(e){var t=this;Object.defineProperty(e,"onChannelClose",{value:function(){t.unregisterDownlink(e),e.__proto__.onChannelClose.call(e)},configurable:!0}),this.downlinks.push(e)},r.prototype.unregisterDownlink=function(e){for(var t=0,n=this.downlinks.length;t<n;t+=1)if(e===this.downlinks[t])return void this.downlinks.splice(t,1)},r.prototype.close=function(){this.channel.unregisterDelegate(this);var e=this.downlinks;Object.defineProperty(this,"downlinks",{value:[],configurable:!0});for(var t=0,n=e.length;t<n;t+=1){var i=e[t];i.close()}},o.prototype=Object.create(r.prototype),o.prototype.constructor=o,o.prototype.authorize=function(e){this.channel.authorize(e)},o.prototype.downlink=function(){return new c(this.channel,this).host(this.hostUri)},o.prototype.link=function(e,t,n){var r=this.channel.link(i.resolveNodeUri(this.hostUri,e),t,n);return this.registerDownlink(r),r},o.prototype.sync=function(e,t,n){var r=this.channel.sync(i.resolveNodeUri(this.hostUri,e),t,n);return this.registerDownlink(r),r},o.prototype.syncList=function(e,t,n){var r=this.channel.syncList(i.resolveNodeUri(this.hostUri,e),t,n);return this.registerDownlink(r),r},o.prototype.syncMap=function(e,t,n){var r=this.channel.syncMap(i.resolveNodeUri(this.hostUri,e),t,n);return this.registerDownlink(r),r},o.prototype.command=function(e,t,n){this.channel.command(i.resolveNodeUri(this.hostUri,e),t,n)},o.prototype.node=function(e){return new s(this.channel,this.hostUri,i.resolveNodeUri(this.hostUri,e))},o.prototype.lane=function(e,t){return new p(this.channel,this.hostUri,i.resolveNodeUri(this.hostUri,e),t)},s.prototype=Object.create(r.prototype),s.prototype.constructor=s,s.prototype.downlink=function(){return new c(this.channel,this).host(this.hostUri).node(this.nodeUri)},s.prototype.link=function(e,t){var n=this.channel.link(this.nodeUri,e,t);return this.registerDownlink(n),n},s.prototype.sync=function(e,t){var n=this.channel.sync(this.nodeUri,e,t);return this.registerDownlink(n),n},s.prototype.syncList=function(e,t){var n=this.channel.syncList(this.nodeUri,e,t);return this.registerDownlink(n),n},s.prototype.syncMap=function(e,t){var n=this.channel.syncMap(this.nodeUri,e,t);return this.registerDownlink(n),n},s.prototype.command=function(e,t){this.channel.command(this.nodeUri,e,t)},s.prototype.lane=function(e){return new p(this.channel,this.hostUri,this.nodeUri,e)},p.prototype=Object.create(r.prototype),p.prototype.constructor=p,p.prototype.downlink=function(){return new c(this.channel,this).host(this.hostUri).node(this.nodeUri).lane(this.laneUri)},p.prototype.link=function(e){var t=this.channel.link(this.nodeUri,this.laneUri,e);return this.registerDownlink(t),t},p.prototype.sync=function(e){var t=this.channel.sync(this.nodeUri,this.laneUri,e);return this.registerDownlink(t),t},p.prototype.syncList=function(e){var t=this.channel.syncList(this.nodeUri,this.laneUri,e);return this.registerDownlink(t),t},p.prototype.syncMap=function(e){var t=this.channel.syncMap(this.nodeUri,this.laneUri,e);return this.registerDownlink(t),t},p.prototype.command=function(e){this.channel.command(this.nodeUri,this.laneUri,e)},Object.defineProperty(a.prototype,"protocols",{get:function(){return this.options.protocols}}),Object.defineProperty(a.prototype,"maxReconnectTimeout",{get:function(){return this.options.maxReconnectTimeout||3e4}}),Object.defineProperty(a.prototype,"idleTimeout",{get:function(){return this.options.idleTimeout||1e3}}),Object.defineProperty(a.prototype,"sendBufferSize",{get:function(){return this.options.sendBufferSize||1024}}),a.prototype.resolve=function(e){return this.uriCache.resolve(e)},a.prototype.unresolve=function(e){return this.uriCache.unresolve(e)},a.prototype.authorize=function(e){if(!w.equal(e,this.credentials))if(this.credentials=e,this.isConnected){var t=new E.AuthRequest(e);this.push(t)}else this.open()},a.prototype.link=function(e,t,n){var i=new d(this,this.hostUri,e,t,n);return this.registerDownlink(i),i},a.prototype.sync=function(e,t,n){var i=new y(this,this.hostUri,e,t,n);return this.registerDownlink(i),i},a.prototype.syncList=function(e,t,n){var i=new v(this,this.hostUri,e,t,n);return this.registerDownlink(i),i},a.prototype.syncMap=function(e,t,n){var i=new m(this,this.hostUri,e,t,n);return this.registerDownlink(i),i},a.prototype.command=function(e,t,n){var i=new E.CommandMessage(this.unresolve(e),t,n);this.push(i)},a.prototype.registerDelegate=function(e){this.delegates.push(e)},a.prototype.unregisterDelegate=function(e){for(var t=0,n=this.delegates.length;t<n;t+=1)this.delegates[t]===e&&this.delegates.splice(t,1)},a.prototype.registerDownlink=function(e){this.clearIdle();var t=e.nodeUri,n=e.laneUri,i=this.downlinks[t]||{},r=i[n]||[];r.push(e),i[n]=r,this.downlinks[t]=i,this.isConnected?e.onChannelConnect({hostUri:this.hostUri}):this.open()},a.prototype.unregisterDownlink=function(e){var t=e.nodeUri,n=e.laneUri,i=this.downlinks[t];if(i){var r=i[n];if(r)for(var o=0,s=r.length;o<s;o+=1)if(r[o]===e){if(r.splice(o,1),0===r.length&&(delete i[n],0===Object.keys(i).length&&(delete this.downlinks[t],this.watchIdle()),this.isConnected)){var p=new E.UnlinkRequest(this.unresolve(t),n);e.onUnlinkRequest(p),this.push(p)}e.onChannelClose()}}},a.prototype.onEnvelope=function(e){e.isEventMessage?this.onEventMessage(e):e.isCommandMessage?this.onCommandMessage(e):e.isLinkRequest?this.onLinkRequest(e):e.isLinkedResponse?this.onLinkedResponse(e):e.isSyncRequest?this.onSyncRequest(e):e.isSyncedResponse?this.onSyncedResponse(e):e.isUnlinkRequest?this.onUnlinkRequest(e):e.isUnlinkedResponse?this.onUnlinkedResponse(e):e.isAuthRequest?this.onAuthRequest(e):e.isAuthedResponse?this.onAuthedResponse(e):e.isDeauthRequest?this.onDeauthRequest(e):e.isDeauthedResponse&&this.onDeauthedResponse(e)},a.prototype.onEventMessage=function(e){var t=this.resolve(e.node),n=e.lane,i=this.downlinks[t];if(i){var r=i[n];if(r)for(var o=e.withAddress(t),s=0,p=r.length;s<p;s+=1){var a=r[s];a.onEventMessage(o)}}},a.prototype.onCommandMessage=function(e){},a.prototype.onLinkRequest=function(e){},a.prototype.onLinkedResponse=function(e){var t=this.resolve(e.node),n=e.lane,i=this.downlinks[t];if(i){var r=i[n];if(r)for(var o=e.withAddress(t),s=0,p=r.length;s<p;s+=1){var a=r[s];a.onLinkedResponse(o)}}},a.prototype.onSyncRequest=function(e){},a.prototype.onSyncedResponse=function(e){var t=this.resolve(e.node),n=e.lane,i=this.downlinks[t];if(i){var r=i[n];if(r)for(var o=e.withAddress(t),s=0,p=r.length;s<p;s+=1){var a=r[s];a.onSyncedResponse(o)}}},a.prototype.onUnlinkRequest=function(e){},a.prototype.onUnlinkedResponse=function(e){var t=this.resolve(e.node),n=e.lane,i=this.downlinks[t];if(i){var r=i[n];if(r){delete i[n],0===Object.keys(i).length&&delete this.downlinks[t];for(var o=e.withAddress(t),s=0,p=r.length;s<p;s+=1){var a=r[s];a.onUnlinkedResponse(o),a.onChannelClose()}}}},a.prototype.onAuthRequest=function(e){},a.prototype.onAuthedResponse=function(e){this.isAuthorized=!0,this.session=e.body;var t={hostUri:this.hostUri,session:this.session};this.client.onChannelAuthorize(t);for(var n=0,i=this.delegates.length;n<i;n+=1){var r=this.delegates[n];r.onChannelAuthorize(t)}},a.prototype.onDeauthRequest=function(e){},a.prototype.onDeauthedResponse=function(e){this.isAuthorized=!1,this.session=null;var t={hostUri:this.hostUri,session:e.body};this.client.onChannelDeauthorize(t);for(var n=0,i=this.delegates.length;n<i;n+=1){var r=this.delegates[n];r.onChannelDeauthorize(t)}},a.prototype.onConnect=function(){var e={hostUri:this.hostUri};this.client.onChannelConnect(e);for(var t=0,n=this.delegates.length;t<n;t+=1){var i=this.delegates[t];i.onChannelConnect(e)}for(var r in this.downlinks){var o=this.downlinks[r];for(var s in o){var p=o[s];for(t=0,n=p.length;t<n;t+=1){var a=p[t];a.onChannelConnect(e)}}}},a.prototype.onDisconnect=function(){var e={hostUri:this.hostUri};this.client.onChannelDisconnect(e);for(var t=0,n=this.delegates.length;t<n;t+=1){var i=this.delegates[t];i.onChannelDisconnect(e)}for(var r in this.downlinks){var o=this.downlinks[r];for(var s in o){var p=o[s].slice();for(t=0,n=p.length;t<n;t+=1){var a=p[t];a.onChannelDisconnect(e)}}}},a.prototype.onError=function(){var e={hostUri:this.hostUri};this.client.onChannelError(e);for(var t=0,n=this.delegates.length;t<n;t+=1){var i=this.delegates[t];i.onChannelError(e)}for(var r in this.downlinks){var o=this.downlinks[r];for(var s in o){var p=o[s];for(t=0,n=p.length;t<n;t+=1){var a=p[t];a.onChannelError(e)}}}},a.prototype.reconnect=function(){if(!this.reconnectTimer){if(this.reconnectTimeout){var e=this.maxReconnectTimeout||3e4;this.reconnectTimeout=Math.min(1.8*this.reconnectTimeout,e)}else{var t=1e3*Math.random();this.reconnectTimeout=500+t}this.reconnectTimer=setTimeout(this.open.bind(this),this.reconnectTimeout)}},a.prototype.clearReconnect=function(){this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null,this.reconnectTimeout=0)},a.prototype.clearIdle=function(){this.idleTimer&&(clearTimeout(this.idleTimer),this.idleTimer=null)},a.prototype.watchIdle=function(){this.isConnected&&0===this.sendBuffer.length&&0===Object.keys(this.downlinks).length&&(this.idleTimer=setTimeout(this.checkIdle.bind(this),this.idleTimeout))},a.prototype.checkIdle=function(){0===this.sendBuffer.length&&0===Object.keys(this.downlinks).length&&this.close()},a.prototype.close=function(){var e=this.downlinks;Object.defineProperty(this,"downlinks",{value:{},configurable:!0});for(var t in e){var n=e[t];for(var i in n)for(var r=n[i],o=0,s=r.length;o<s;o+=1){var p=r[o];p.onChannelClose()}}},u.prototype=Object.create(a.prototype),u.prototype.constructor=u,Object.defineProperty(u.prototype,"isConnected",{get:function(){return this.socket&&this.socket.readyState===this.socket.OPEN},enumerable:!0}),u.prototype.open=function(){this.clearReconnect(),this.socket||(this.socket=this.protocols?new k(this.hostUri,this.protocols):new k(this.hostUri),this.socket.onopen=this.onWebSocketOpen.bind(this),this.socket.onmessage=this.onWebSocketMessage.bind(this),this.socket.onerror=this.onWebSocketError.bind(this),this.socket.onclose=this.onWebSocketClose.bind(this))},u.prototype.close=function(){this.clearReconnect(),this.clearIdle(),this.socket&&(this.socket.close(),this.socket=null),a.prototype.close.call(this)},u.prototype.push=function(e){if(this.isConnected){this.clearIdle();var t=E.stringify(e);this.socket.send(t),this.watchIdle()}else e.isCommandMessage&&(this.sendBuffer.length<this.sendBufferSize&&this.sendBuffer.push(e),this.open())},u.prototype.onWebSocketOpen=function(){if(this.credentials){var e=new E.AuthRequest(this.credentials);this.push(e)}this.onConnect();for(var t;t=this.sendBuffer.shift();)this.push(t);this.watchIdle()},u.prototype.onWebSocketMessage=function(e){var t=e.data;if("string"==typeof t){var n=E.parse(t);n&&this.onEnvelope(n)}},u.prototype.onWebSocketError=function(){this.onError(),this.clearIdle(),this.socket&&(this.socket.onopen=null,this.socket.onmessage=null,this.socket.onerror=null,this.socket.onclose=null,this.socket.close(),this.socket=null)},u.prototype.onWebSocketClose=function(){this.isAuthorized=!1,this.session=null,this.socket=null,this.onDisconnect(),this.clearIdle(),(this.sendBuffer.length>0||Object.keys(this.downlinks).length>0)&&this.reconnect()},h.prototype=Object.create(a.prototype),h.prototype.constructor=h,Object.defineProperty(h.prototype,"sendDelay",{get:function(){return this.options.sendDelay||100}}),Object.defineProperty(h.prototype,"isConnected",{get:function(){return this.socket&&this.socket.readyState>=1},enumerable:!0}),h.prototype.throttleSend=function(){this.sendTimer||(this.sendTimer=setTimeout(this.send.bind(this),this.sendDelay))},h.prototype.clearSend=function(){this.sendTimer&&(clearTimeout(this.sendTimer),this.sendTimer=null)},h.prototype.open=function(){this.clearReconnect(),this.socket||(this.socket=new XMLHttpRequest,this.socket.open("POST",this.hostUri),this.socket.onreadystatechange=this.onHttpSocketChange.bind(this),this.socket.onloadstart=this.onHttpSocketOpen.bind(this),this.socket.onprogress=this.onHttpSocketData.bind(this),this.socket.onload=this.onHttpSocketData.bind(this),this.socket.onerror=this.onHttpSocketError.bind(this),this.socket.onloadend=this.onHttpSocketClose.bind(this),this.socket.setRequestHeader("X-Swim-Connection","Upgrade"),this.socket.send())},h.prototype.close=function(){this.clearReconnect(),this.clearIdle(),this.clearSend(),this.socket&&(this.socket.abort(),this.socket=null),a.prototype.close.call(this)},h.prototype.send=function(){if(this.clearSend(),!this.channelId)return void this.throttleSend();var e=new XMLHttpRequest;e.open("POST",this.hostUri),e.setRequestHeader("X-Swim-Channel",this.channelId),this.watchIdle();for(var t,n="";t=this.sendBuffer.shift();)n=n+E.stringify(t)+"\n";e.send(n)},h.prototype.push=function(e){this.isConnected?(this.clearIdle(),this.sendBuffer.push(e),this.throttleSend()):e.isCommandMessage&&(this.sendBuffer.length<this.sendBufferSize&&this.sendBuffer.push(e),this.open())},h.prototype.onHttpSocketOpen=function(){this.parser=new w.BlockParser,this.offset=0,this.onConnect(),this.watchIdle()},h.prototype.onHttpSocketChange=function(){2===this.socket.readyState&&(this.channelId=this.socket.getResponseHeader("X-Swim-Channel"),this.channelId||this.socket.abort())},h.prototype.onHttpSocketData=function(){for(var e=new l(this.socket.responseText,this.offset,!0);(!e.isInputEmpty()||e.isInputDone())&&this.parser.isCont();){for(var t=this.parser;(!e.isEmpty()||e.isDone())&&t.isCont();)t=t.feed(e);if(e.isInputEmpty()||10!==e.head()||e.step(),this.offset=e.index,t.isDone()){var n=E.decode(t.state());n&&this.onEnvelope(n),this.parser=new w.BlockParser}else{if(t.isError()){this.parser=new w.BlockParser;break}this.parser=t}}},h.prototype.onHttpSocketError=function(){this.onError(),this.clearIdle()},h.prototype.onHttpSocketClose=function(){this.isAuthorized=!1,this.session=null,this.socket=null,this.onDisconnect(),this.clearIdle(),(this.sendBuffer.length>0||Object.keys(this.downlinks).length>0)&&this.reconnect()},l.prototype=Object.create(w.StringIterator.prototype),l.prototype.constructor=l,l.prototype.isDone=function(){return this.index>=this.string.length&&!this.more||this.index<this.string.length&&10===this.head()},l.prototype.isEmpty=function(){return this.index>=this.string.length||10===this.head()},l.prototype.isInputDone=function(){return w.StringIterator.prototype.isDone.call(this)},l.prototype.isInputEmpty=function(){return w.StringIterator.prototype.isEmpty.call(this)},c.prototype.host=function(e){return arguments.length?(this.hostUri=e,this):this.hostUri},c.prototype.node=function(e){return arguments.length?(this.nodeUri=e,this):this.nodeUri},c.prototype.lane=function(e){return arguments.length?(this.laneUri=e,this):this.laneUri},c.prototype.prio=function(e){return arguments.length?(this.options.prio=e,this):this.options.prio},c.prototype.keepAlive=function(e){return arguments.length?(this.options.keepAlive=e,this):this.options.keepAlive},c.prototype.delegate=function(e){return arguments.length?(this.options.delegate=e,this):this.options.delegate},c.prototype.onEvent=function(e){return arguments.length?(this.proxy.onEvent=e,this):this.proxy.onEvent},c.prototype.onCommand=function(e){return arguments.length?(this.proxy.onCommand=e,this):this.proxy.onCommand},c.prototype.onLink=function(e){return arguments.length?(this.proxy.onLink=e,this):this.proxy.onLink},c.prototype.onLinked=function(e){return arguments.length?(this.proxy.onLinked=e,this):this.proxy.onLinked},c.prototype.onSync=function(e){return arguments.length?(this.proxy.onSync=e,this):this.proxy.onSync},c.prototype.onSynced=function(e){return arguments.length?(this.proxy.onSynced=e,this):this.proxy.onSynced},c.prototype.onUnlink=function(e){return arguments.length?(this.proxy.onUnlink=e,this):this.proxy.onUnlink},c.prototype.onUnlinked=function(e){return arguments.length?(this.proxy.onUnlinked=e,this):this.proxy.onUnlinked},c.prototype.onConnect=function(e){return arguments.length?(this.proxy.onConnect=e,this):this.proxy.onConnect},c.prototype.onDisconnect=function(e){return arguments.length?(this.proxy.onDisconnect=e,this):this.proxy.onDisconnect},c.prototype.onError=function(e){return arguments.length?(this.proxy.onError=e,this):this.proxy.onError},c.prototype.onClose=function(e){return arguments.length?(this.proxy.onClose=e,this):this.proxy.onClose},c.prototype.primaryKey=function(e){return arguments.length?(this.options.primaryKey=e,this):this.options.primaryKey},c.prototype.sortBy=function(e){return arguments.length?(this.options.sortBy=e,this):this.options.sortBy},Object.defineProperty(c.prototype,"normalize",{value:function(){this.hostUri?this.nodeUri=i.resolveNodeUri(this.hostUri,this.nodeUri):this.hostUri=i.extractHostUri(this.nodeUri),this.channel||(Object.defineProperty(this,"channel",{value:this.scope.getOrCreateChannel(this.hostUri),configurable:!0}),Object.defineProperty(this,"scope",{value:null,configurable:!0}))},configurable:!0}),Object.defineProperty(c.prototype,"registerDownlink",{value:function(e){for(var t in this.proxy)e[t]=this.proxy[t];this.channel.registerDownlink(e),this.scope&&this.scope.registerDownlink(e)},configure:!0}),c.prototype.link=function(){this.normalize();var e=new d(this.channel,this.hostUri,this.nodeUri,this.laneUri,this.options);return this.registerDownlink(e),e},c.prototype.sync=function(){this.normalize();var e=new y(this.channel,this.hostUri,this.nodeUri,this.laneUri,this.options);return this.registerDownlink(e),e},c.prototype.syncList=function(){this.normalize();var e=new v(this.channel,this.hostUri,this.nodeUri,this.laneUri,this.options);return this.registerDownlink(e),e},c.prototype.syncMap=function(){this.normalize();var e=new m(this.channel,this.hostUri,this.nodeUri,this.laneUri,this.options);return this.registerDownlink(e),e},Object.defineProperty(f.prototype,"prio",{get:function(){return this.options.prio||0}}),Object.defineProperty(f.prototype,"keepAlive",{get:function(){return this.options.keepAlive||!1},set:function(e){this.options.keepAlive=e}}),Object.defineProperty(f.prototype,"isConnected",{get:function(){return this.channel.isConnected},enumerable:!0}),Object.defineProperty(f.prototype,"isAuthorized",{get:function(){return this.channel.isAuthorized},enumerable:!0}),Object.defineProperty(f.prototype,"session",{get:function(){return this.channel.session},enumerable:!0}),Object.defineProperty(f.prototype,"onEventMessage",{value:function(e){"function"==typeof this.delegate.onEvent&&this.delegate.onEvent(e)},configurable:!0}),Object.defineProperty(f.prototype,"onCommandMessage",{value:function(e){"function"==typeof this.delegate.onCommand&&this.delegate.onCommand(e)},configurable:!0}),Object.defineProperty(f.prototype,"onLinkRequest",{value:function(e){"function"==typeof this.delegate.onLink&&this.delegate.onLink(e)},configurable:!0}),Object.defineProperty(f.prototype,"onLinkedResponse",{value:function(e){"function"==typeof this.delegate.onLinked&&this.delegate.onLinked(e)},configurable:!0}),Object.defineProperty(f.prototype,"onSyncRequest",{value:function(e){"function"==typeof this.delegate.onSync&&this.delegate.onSync(e)},configurable:!0}),Object.defineProperty(f.prototype,"onSyncedResponse",{value:function(e){"function"==typeof this.delegate.onSynced&&this.delegate.onSynced(e)},configurable:!0}),Object.defineProperty(f.prototype,"onUnlinkRequest",{value:function(e){"function"==typeof this.delegate.onUnlink&&this.delegate.onUnlink(e)},configurable:!0}),Object.defineProperty(f.prototype,"onUnlinkedResponse",{value:function(e){"function"==typeof this.delegate.onUnlinked&&this.delegate.onUnlinked(e)},configurable:!0}),Object.defineProperty(f.prototype,"onChannelConnect",{value:function(e){"function"==typeof this.delegate.onConnect&&this.delegate.onConnect(e)},configurable:!0}),Object.defineProperty(f.prototype,"onChannelDisconnect",{value:function(e){"function"==typeof this.delegate.onDisconnect&&this.delegate.onDisconnect(e),this.keepAlive||this.close()},configurable:!0}),Object.defineProperty(f.prototype,"onChannelError",{value:function(e){"function"==typeof this.delegate.onError&&this.delegate.onError(e)},configurable:!0}),Object.defineProperty(f.prototype,"onChannelClose",{value:function(){"function"==typeof this.delegate.onClose&&this.delegate.onClose()},configurable:!0}),f.prototype.command=function(e){this.channel.command(this.nodeUri,this.laneUri,e)},f.prototype.close=function(){this.channel.unregisterDownlink(this)},d.prototype=Object.create(f.prototype),d.prototype.constructor=d,Object.defineProperty(d.prototype,"onChannelConnect",{value:function(e){f.prototype.onChannelConnect.call(this,e);var t=this.channel.unresolve(this.nodeUri),n=new E.LinkRequest(t,this.laneUri,this.prio);this.onLinkRequest(n),this.channel.push(n)},configurable:!0}),y.prototype=Object.create(f.prototype),y.prototype.constructor=y,Object.defineProperty(y.prototype,"onChannelConnect",{value:function(e){f.prototype.onChannelConnect.call(this,e);var t=this.channel.unresolve(this.nodeUri),n=new E.SyncRequest(t,this.laneUri,this.prio);this.onSyncRequest(n),this.channel.push(n)},configurable:!0}),v.prototype=Object.create(y.prototype),v.prototype.constructor=v,Object.defineProperty(v.prototype,"onEventMessage",{value:function(e){var t,n,i,r=w.tag(e.body);if("@update"===r)t=w.head(e.body),n=w.get(t,"index"),i=w.tail(e.body),this.remoteUpdate(n,i);else if("@insert"===r)t=w.head(e.body),n=w.get(t,"index"),i=w.tail(e.body),this.remoteInsert(n,i);else if("@move"===r){t=w.head(e.body);var o=w.get(t,"from"),s=w.get(t,"to");i=w.tail(e.body),this.remoteMove(o,s,i)}else"@remove"===r||"@delete"===r?(t=w.head(e.body),n=w.get(t,"index"),i=w.tail(e.body),this.remoteRemove(n,i)):"@clear"===r&&1===w.size(e.body)?this.remoteClear():this.remoteAppend(e.body);y.prototype.onEventMessage.call(this,e)},configurable:!0}),Object.defineProperty(v.prototype,"remoteAppend",{value:function(e){this.state.push(e)},configurable:!0}),Object.defineProperty(v.prototype,"remoteUpdate",{value:function(e,t){this.state[e]=t},configurable:!0}),Object.defineProperty(v.prototype,"remoteInsert",{value:function(e,t){w.equal(this.state[e],t)||this.state.splice(e,0,t)},configurable:!0}),Object.defineProperty(v.prototype,"remoteMove",{value:function(e,t,n){w.equal(this.state[t],n)||(this.state.splice(e,1),this.state.splice(t,0,n))},configurable:!0}),Object.defineProperty(v.prototype,"remoteRemove",{value:function(e,t){w.equal(this.state[e],t)&&this.state.splice(e,1)},configurable:!0}),Object.defineProperty(v.prototype,"remoteClear",{value:function(e,t){
Object.defineProperty(this,"state",{value:[],configurable:!0})},configurable:!0}),Object.defineProperty(v.prototype,"length",{get:function(){return this.state.length},configurable:!0,enumerable:!0}),v.prototype.get=function(e){return this.state[e]},v.prototype.set=function(e,t){t=w(void 0!==t?t:this.get(e)),this.state[e]=t;var n=this.channel.unresolve(this.nodeUri),i=w.concat(w({"@update":w({index:e})}),t),r=new E.CommandMessage(n,this.laneUri,i);this.onCommandMessage(r),this.channel.push(r)},v.prototype.push=function(){for(var e=this.channel.unresolve(this.nodeUri),t=0,n=arguments.length;t<n;t+=1){var i=w(arguments[t]);this.state.push(i);var r=new E.CommandMessage(e,this.laneUri,i);this.onCommandMessage(r),this.channel.push(r)}return this.state.length},v.prototype.pop=function(){var e=this.state.pop(),t=this.state.length;if(void 0!==e){var n=this.channel.unresolve(this.nodeUri),i=w.concat(w({"@remove":w({index:t})}),e),r=new E.CommandMessage(n,this.laneUri,i);this.onCommandMessage(r),this.channel.push(r)}return e},v.prototype.unshift=function(){for(var e=this.channel.unresolve(this.nodeUri),t=arguments.length-1;t>=0;t-=1){var n=w(arguments[t]);this.state.unshift(n);var i=w.concat(w({"@insert":w({index:0})}),n),r=new E.CommandMessage(e,this.laneUri,i);this.onCommandMessage(r),this.channel.push(r)}return this.state.length},v.prototype.shift=function(){var e=this.state.shift();if(void 0!==e){var t=this.channel.unresolve(this.nodeUri),n=w.concat(w({"@remove":w({index:0})}),e),i=new E.CommandMessage(t,this.laneUri,n);this.onCommandMessage(i),this.channel.push(i)}return e},v.prototype.move=function(e,t){var n=this.state.splice(e,1);if(1===n.length){var i=n[0];this.state.splice(t,0,i);var r=this.channel.unresolve(this.nodeUri),o=w.concat(w({"@move":w({from:e,to:t})}),i),s=new E.CommandMessage(r,this.laneUri,o);this.onCommandMessage(s),this.channel.push(s)}},v.prototype.splice=function(){var e,t,n,i,r,o=arguments[0],s=arguments[1],p=this.channel.unresolve(this.nodeUri),a=[];for(e=o;e<o+s;e+=1)n=this.state[e],void 0!==n&&(a.push(n),this.state.splice(o,1),i=w.concat(w({"@remove":w({index:o})}),n),r=new E.CommandMessage(p,this.laneUri,i),this.onCommandMessage(r),this.channel.push(r));for(e=2,t=arguments.length;e<t;e+=1){var u=o+e-2;n=w(arguments[e]),this.state.splice(u,0,n),i=w.concat(w({"@insert":w({index:u})}),n),r=new E.CommandMessage(p,this.laneUri,i),this.onCommandMessage(r),this.channel.push(r)}return a},v.prototype.clear=function(){Object.defineProperty(this,"state",{value:[],configurable:!0});var e=this.channel.unresolve(this.nodeUri),t=new E.CommandMessage(e,this.laneUri,[{"@clear":null}]);return this.onCommandMessage(t),this.channel.push(t),this},v.prototype.forEach=function(e,t){for(var n=0,i=this.state.length;n<i;n+=1){var r=this.state[n];e.call(t,r,n,this)}},m.prototype=Object.create(y.prototype);m.prototype.constructor=m;Object.defineProperty(m.prototype,"onEventMessage",{value:function(e){var t,n,i,r=w.tag(e.body);"@update"===r?(t=w.head(e.body),n=w.get(t,"key"),i=w.tail(e.body),this.remoteSet(n,i)):"@remove"===r||"@delete"===r?(t=w.head(e.body),n=w.get(t,"key"),void 0===n&&this.primaryKey&&(n=this.primaryKey(e.body)),void 0!==n&&this.remoteDelete(n)):"@clear"===r&&1===w.size(e.body)?this.remoteClear():this.primaryKey&&(i=e.body,n=this.primaryKey(i),void 0!==n&&this.remoteSet(n,i)),y.prototype.onEventMessage.call(this,e)},configurable:!0}),Object.defineProperty(m.prototype,"remoteSet",{value:function(e,t){Object.defineProperty(t,"$key",{value:e,configurable:!0}),"string"==typeof e&&(this.table[e]=t);for(var n=0,i=this.state.length;n<i;n+=1)if(w.equal(e,this.state[n].$key)){this.state[n]=t;break}n===i&&this.state.push(t),this.sort()},configurable:!0}),Object.defineProperty(m.prototype,"remoteDelete",{value:function(e){"string"==typeof e&&delete this.table[e];for(var t=0,n=this.state.length;t<n;t+=1)if(w.equal(e,this.state[t].$key))return void this.state.splice(t,1)},configurable:!0}),Object.defineProperty(m.prototype,"remoteClear",{value:function(e){Object.defineProperty(this,"state",{value:[],configurable:!0}),Object.defineProperty(this,"table",{value:{},configurable:!0})},configurable:!0}),Object.defineProperty(m.prototype,"size",{get:function(){return this.state.length},configurable:!0,enumerable:!0}),m.prototype.has=function(e){if("string"==typeof e)return void 0!==this.table[e];for(var t=0,n=this.state.length;t<n;t+=1)if(w.equal(e,this.state[t].$key))return!0;return!1},m.prototype.get=function(e){if("string"==typeof e)return this.table[e];for(var t=0,n=this.state.length;t<n;t+=1){var i=this.state[t];if(w.equal(e,i.$key))return i}},m.prototype.set=function(e,t){t=w(void 0!==t?t:this.get(e)),Object.defineProperty(t,"$key",{value:e,configurable:!0}),"string"==typeof e&&(this.table[e]=t);for(var n,i=0,r=this.state.length;i<r;i+=1)if(w.equal(e,this.state[i].$key)){n=this.state[i],this.state[i]=t;break}if(i===r&&this.state.push(t),this.sort(),!w.equal(t,n)){var o,s=this.channel.unresolve(this.nodeUri);o=this.primaryKey?w(t):w.concat(w({"@update":{key:e}}),w(t));var p=new E.CommandMessage(s,this.laneUri,o);this.onCommandMessage(p),this.channel.push(p)}return this},m.prototype.delete=function(e){"string"==typeof e&&delete this.table[e];for(var t=0,n=this.state.length;t<n;t+=1){var i=this.state[t];if(w.equal(e,i.$key)){this.state.splice(t,1);var r,o=this.channel.unresolve(this.nodeUri);r=this.primaryKey?w.concat(w({"@remove":null}),i):w({"@remove":{key:e}});var s=new E.CommandMessage(o,this.laneUri,r);return this.onCommandMessage(s),this.channel.push(s),!0}}return!1},m.prototype.clear=function(){Object.defineProperty(this,"state",{value:[],configurable:!0}),Object.defineProperty(this,"table",{value:{},configurable:!0});var e=this.channel.unresolve(this.nodeUri),t=new E.CommandMessage(e,this.laneUri,[{"@clear":null}]);return this.onCommandMessage(t),this.channel.push(t),this},m.prototype.sort=function(){this.sortBy&&this.state.sort(this.sortBy)},m.prototype.keys=function(){for(var e=[],t=0,n=this.state.length;t<n;t+=1){var i=this.state[t].$key;void 0!==i&&e.push(i)}return e},m.prototype.values=function(){return this.state},m.prototype.forEach=function(e,t){for(var n=0,i=this.state.length;n<i;n+=1){var r=this.state[n],o=r.$key;e.call(t,r,o,this)}},m.primaryKeyOption=function(e){if("function"==typeof e.primaryKey)return e.primaryKey;if("string"==typeof e.primaryKey){var t=e.primaryKey.split(".");return function(e){for(var n=0,i=t.length;n<i;n+=1){var r=t[n];e=w.get(e,r)}return e}}},m.sortByOption=function(e){if("function"==typeof e.sortBy)return e.sortBy;if("string"==typeof e.sortBy){var t=e.sortBy.split(".");return function(e,n){for(var i=0,r=t.length;i<r;i+=1){var o=t[i];return e=w.get(e,o),n=w.get(n,o),w.compare(e,n)}}}},b.prototype.resolve=function(e){var t=Math.abs(b.hash(e)%this.size),n=this.resolveCache[t];if(n&&n.unresolved===e)return n.resolved;var i=w.uri.stringify(w.uri.resolve(this.base,e));return this.resolveCache[t]={unresolved:e,resolved:i},i},b.prototype.unresolve=function(e){var t=Math.abs(b.hash(e)%this.size),n=this.unresolveCache[t];if(n&&n.resolved===e)return n.unresolved;var i=w.uri.stringify(w.uri.unresolve(this.base,e));return this.unresolveCache[t]={unresolved:i,resolved:e},i},b.rotl=function(e,t){return e<<t|e>>>32-t},b.mix=function(e,t){return t*=3432918353,t=b.rotl(t,15),t*=461845907,e^=t,e=b.rotl(e,13),e=5*e+3864292196},b.mash=function(e){return e^=e>>>16,e*=2246822507,e^=e>>>13,e*=3266489909,e^=e>>>16},b.hash=function(e){for(var t=0,n=0,i=e.length;n<i;n+=1)t=b.mix(t,e.charAt(n));return t=b.mash(t)};var O=new i;O.client=function(e){return new i(e)},O.config=g,O.Client=i,O.Scope=r,O.HostScope=o,O.NodeScope=s,O.LaneScope=p,O.Channel=a,O.DownlinkBuilder=c,O.Downlink=f,O.LinkedDownlink=d,O.SyncedDownlink=y,O.ListDownlink=v,O.MapDownlink=m,e.exports=O}).call(t,function(){return this}())},function(e,t){e.exports={version:"0.4.8"}},function(e,t,n){"use strict";function i(e){var t=new $(e),n=(new Z).run(t);return n.state()}function r(e,t){var n=new he;return t&&t.block===!1?n.writeValue(e):n.writeBlock(e),n.state()}function o(e){if(void 0===e)return new Uint8Array(0);for(var t=new K,n=new $(e);!n.isEmpty();)t.appendBase64Char(n.head()),n.step();return t.state()}function s(e){return Array.isArray(e)&&!(e instanceof Uint8Array)}function p(e){return null!==e&&"object"==typeof e&&!(e instanceof Uint8Array)}function a(e){return!(null===e||"object"!=typeof e||Array.isArray(e)||e instanceof Uint8Array)}function u(e){if(!a(e))return!1;var t=Object.keys(e),n=t.length;if(0===n)return!1;for(var i=0;i<n;i+=1){var r=t[i];if(0===r.length||64!==r.charCodeAt(0))return!1}return!0}function h(e){for(var t=0,n=e.length;t<n;t+=1)if(u(e[t]))return!1;return!0}function l(e){var t=e.length;if(0===t||!u(e[0]))return!1;for(var n=1;n<t;n+=1)if(u(e[n]))return!1;return!0}function c(e){return s(e)?e.length:p(e)?Object.keys(e).length:0}function f(e){if(s(e)){var t=e[0];return a(t)?t.$key?t.$value:t[Object.keys(t)[0]]:t}return p(e)?e[Object.keys(e)[0]]:e}function d(e){var t,n,i;if(s(e)){for(i=new N,t=1,n=e.length;t<n;t+=1)i.appendItem(e[t]);return i.state()}if(p(e)){var r=Object.keys(e);for(t=1,n=r.length;t<n;t+=1){var o=r[t];i.appendField(o,e[o])}return i.state()}}function y(e){if(s(e)){var t=e[0];if(a(t))return t.$key||Object.keys(t)[0]}else if(p(e))return Object.keys(e)[0]}function v(e,t){return void 0!==m(e,t)}function m(e,t){var n,i,r,o;if("string"==typeof t){if(o=e[t],void 0!==o)return o;for(n=0,i=e.length;n<i;n+=1)if(r=e[n],a(r)){if(void 0!==r[t])return r[t];if(P(r.$key,t))return r.$value}}else for(n=0,i=e.length;n<i;n+=1)if(r=e[n],a(r)&&P(r.$key,t))return r.$value}function b(e,t,n){n=z(n),s(e)?g(e,t,n):p(e)&&w(e,t,n)}function g(e,t,n){for(var i,r=!1,o=0,s=e.length;o<s;o+=1){var p=e[o];a(p)&&(void 0!==p[t]?(p[t]=n,r=!0):P(p.$key,t)&&(p.$value=n,r=!0))}"string"==typeof t?(r||(i={},i[t]=n,e.push(i)),e[t]=n):r||(i={},i.$key=t,i.$value=n,e.push(i))}function w(e,t,n){"string"==typeof t&&(e[t]=n)}function E(e,t){s(e)?k(e,t):p(e)&&O(e,t)}function k(e,t){for(var n=0,i=e.length;n<i;n+=1){var r=e[n];a(r)&&(void 0!==r[t]?(delete r[t],delete e[t],0===Object.keys(r).length&&(e.splice(n,1),n-=1,i-=1)):P(r.$key,t)&&(e.splice(n,1),n-=1,i-=1))}}function O(e,t){"string"==typeof t&&delete e[t]}function D(e){if(s(e)){for(var t=[],n=0,i=e.length;n<i;n+=1){var r=e[n];if(a(r)){var o=r.$key;void 0!==o?t.push(o):Array.prototype.push.apply(t,Object.keys(r))}}return t}return p(e)?Object.keys(e):[]}function j(e){var t,n=[];if(s(e))for(var i=0,r=e.length;i<r;i+=1){var o=e[i];if(a(o))if(t=o.$key,void 0!==t)n.push(o.$value);else for(t in o)n.push(o[t]);else n.push(o)}else if(p(e))for(t in e)n.push(e[t]);return n}function C(e,t,n){var i,r;if(s(e))for(var o=0,u=e.length;o<u;o+=1){var h=e[o];if(a(h))if(i=h.$key,void 0!==i)r=h.$value,t.call(n,r,i,e);else for(i in h)r=h[i],t.call(n,r,i,e);else t.call(n,h,void 0,e)}else if(p(e))for(i in e)r=e[i],t.call(n,r,i,e)}function x(e,t){var n=new N;return s(e)?n.appendRecord(e):p(e)?n.appendFields(e):void 0!==e&&n.appendItem(e),s(t)?n.appendRecord(t):p(t)?n.appendFields(t):void 0!==t&&n.appendItem(t),n.state()}function P(e,t){return e===t||(s(e)&&s(t)?U(e,t):a(e)&&a(t)?A(e,t):e instanceof Uint8Array&&t instanceof Uint8Array&&R(e,t))}function U(e,t){var n=e.length;if(n!==t.length)return!1;for(var i=0;i<n;i+=1)if(!P(e[i],t[i]))return!1;return!0}function A(e,t){var n=Object.keys(e),i=Object.keys(t),r=n.length;if(r!==i.length)return!1;for(var o=0;o<r;o+=1){var s=n[o];if(!P(e[s],t[s]))return!1}return!0}function R(e,t){var n=e.length;if(n!==t.length)return!1;for(var i=0;i<n;i+=1)if(e[i]!==t[i])return!1;return!0}function S(e,t){return e===!0?e="true":e===!1&&(e="false"),t===!0?t="true":t===!1&&(t="false"),void 0===e?void 0===t?0:1:null===e?void 0===t?-1:null===t?0:1:"number"==typeof e?void 0===t||null===t?-1:"number"==typeof t?e<t?-1:e>t?1:0:1:"string"==typeof e?void 0===t||null===t||"number"==typeof t?-1:"string"==typeof t?e<t?-1:e>t?1:0:1:e instanceof Uint8Array?void 0===t||null===t||"number"==typeof t||"string"==typeof t?-1:t instanceof Uint8Array?F(e,t):1:Array.isArray(e)?void 0===t||null===t||"number"==typeof t||"string"==typeof t||t instanceof Uint8Array?-1:Array.isArray(t)?I(e,t):1:void 0===t||null===t||"number"==typeof t||"string"==typeof t||t instanceof Uint8Array||Array.isArray(t)?-1:q(e,t)}function I(e,t){for(var n=e.length,i=t.length,r=0,o=Math.min(n,i),s=0;r<o&&0===s;r+=1)s=S(e[r],t[r]);return 0!==s?s:n>i?1:n<i?-1:0}function q(e,t){for(var n=Object.keys(e),i=Object.keys(t),r=n.length,o=i.length,s=0,p=Math.min(r,o),a=0;s<p&&0===a;s+=1){var u=n[s],h=i[s];a=M(u,h),0===a&&(a=S(e[u],t[h]))}return 0!==a?a:r>o?1:r<o?-1:0}function M(e,t){var n=e.length,i=t.length;if(n>0&&i>0){var r=e.charCodeAt(0),o=t.charCodeAt(0);return 64===r&&64!==o?-1:64!==r&&64===o?1:e<t?-1:e>t?1:0}return n>0?1:i>0?-1:0}function F(e,t){for(var n=e.length,i=t.length,r=0,o=Math.min(n,i),s=0;r<o&&0===s;r+=1)s=e[r]-t[r];return s>0?1:s<0?-1:n>i?1:n<i?-1:0}function B(){return 1===arguments.length?z(arguments[0]):arguments.length>1?L(arguments):void 0}function z(e){return s(e)?L(e):p(e)?T(e):e}function L(e){var t,n,i=[];for(t=0,n=e.length;t<n;t+=1)i.push(e[t]);var r=Object.keys(e);for(t=0,n=r.length;t<n;t+=1){var o=r[t];if(isNaN(parseInt(o))&&o.length>0&&36!==o.charCodeAt(0)){var s=z(e[o]);b(i,o,s)}}return i}function T(e){for(var t=Object.keys(e),n=t.length,i=new Array(n),r=0;r<n;r+=1){var o=t[r],s=z(e[o]),p={};p[o]=s,i[r]=p,i[o]=s}return i}function N(){this.items=[]}function V(){this.items=null,this.value=null}function $(e,t,n){this.string=e||"",this.index=t||0,this.more=n||!1}function _(){}function H(e){this.string=e||""}function K(){this.buffer=null,this.offset=0,this.aliased=!0,this.p=0,this.q=0,this.r=0,this.s=0}function W(e){return 32===e||9===e}function Q(e){return 10===e||13===e}function X(e){return W(e)||Q(e)}function J(e){return e>=65&&e<=90||95===e||e>=97&&e<=122||e>=192&&e<=214||e>=216&&e<=246||e>=248&&e<=767||e>=880&&e<=893||e>=895&&e<=8191||e>=8204&&e<=8205||e>=8304&&e<=8591||e>=11264&&e<=12271||e>=12289&&e<=55295||e>=63744&&e<=64975||e>=65008&&e<=65533||e>=65536&&e<=983039}function G(e){return 45===e||e>=48&&e<=57||e>=65&&e<=90||95===e||e>=97&&e<=122||183===e||e>=192&&e<=214||e>=216&&e<=246||e>=248&&e<=893||e>=895&&e<=8191||e>=8204&&e<=8205||e>=8255&&e<=8256||e>=8304&&e<=8591||e>=11264&&e<=12271||e>=12289&&e<=55295||e>=63744&&e<=64975||e>=65008&&e<=65533||e>=65536&&e<=983039}function Y(e){return e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122||43===e||45===e||47===e||95===e}function Z(e){_.call(this),this.value=e||new ee}function ee(e,t,n,i){_.call(this),this.builder=e||null,this.key=t||null,this.value=n||null,this.s=i||1}function te(e,t,n){_.call(this),this.ident=e||null,this.value=t||new ee,this.s=n||1}function ne(e,t,n,i){_.call(this),this.builder=e||null,this.field=t||null,this.value=n||null,this.s=i||1}function ie(e,t,n,i){_.call(this),this.builder=e||null,this.field=t||null,this.value=n||null,this.s=i||1}function re(e,t,n,i){_.call(this),this.builder=e||null,this.key=t||null,this.value=n||null,this.s=i||1}function oe(e,t,n,i){_.call(this),this.builder=e||null,this.text=t||null,this.value=n||null,this.s=i||1}function se(e,t){_.call(this),this.builder=e||null,this.s=t||1}function pe(e,t){_.call(this),this.text=e||null,this.s=t||1}function ae(e,t){_.call(this),this.builder=e||null,this.s=t||1}function ue(e,t){_.call(this),this.data=e||null,this.s=t||1}function he(e){this.builder=e||new H}function le(e){return e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||45===e||46===e||95===e||126===e}function ce(e){return 33===e||36===e||38===e||40===e||41===e||42===e||43===e||44===e||59===e||61===e||39===e}function fe(e){return e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||43===e||45===e||46===e}function de(e){return le(e)||ce(e)||58===e}function ye(e){return le(e)||ce(e)}function ve(e){return le(e)||ce(e)}function me(e){return le(e)||ce(e)||58===e||64===e}function be(e){return le(e)||ce(e)||47===e||58===e||63===e||64===e}function ge(e){return le(e)||33===e||36===e||40===e||41===e||42===e||43===e||44===e||47===e||58===e||59===e||63===e||64===e||39===e}function we(e){return le(e)||ce(e)||47===e||58===e||63===e||64===e}function Ee(e){return e>=65&&e<=90||e>=97&&e<=122}function ke(e){return e>=48&&e<=57}function Oe(e){return e>=65&&e<=70||e>=97&&e<=102||e>=48&&e<=57}function De(e){if(e>=48&&e<=57)return e-48}function je(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?10+(e-65):e>=97&&e<=102?10+(e-97):void 0}function Ce(e){return e<10?48+e:65+(e-10)}function xe(e){return e>=65&&e<=90?e+32:e}function Pe(e,t,n,i,r,o){_.call(this),this.scheme=e||null,this.authority=t||null,this.path=n||null,this.query=i||null,this.fragment=r||null,this.s=o||1}function Ue(e,t){_.call(this),this.builder=e||null,this.s=t||1}function Ae(e,t,n,i){_.call(this),this.userInfo=e||null,this.host=t||null,this.port=n||null,this.s=i||1}function Re(e,t,n,i){_.call(this),this.username=e||null,this.password=t||null,this.c1=n||0,this.s=i||1}function Se(){_.call(this)}function Ie(e,t,n,i){_.call(this),this.builder=e||null,this.c1=t||0,this.x=n||0,this.s=i||1}function qe(e,t){_.call(this),this.builder=e||null,this.s=t||1}function Me(e){_.call(this),this.port=e||0}function Fe(e,t,n,i){_.call(this),this.path=e||null,this.builder=t||null,this.c1=n||0,this.s=i||1}function Be(e,t,n,i,r){_.call(this),this.key=e||null,this.value=t||null,this.query=n||null,this.c1=i||0,this.s=r||1}function ze(e,t,n){_.call(this),this.builder=e||null,this.c1=t||0,this.s=n||1}function Le(e){var t=new $(e),n=(new Pe).run(t);return n.state()}function Te(e){var t=new $(e),n=(new Ae).run(t);return n.state()}function Ne(e){var t=new $(e),n=(new Fe).run(t);return n.state()}function Ve(e){var t=new Xe;return t.writeUri(e),t.state()}function $e(e,t){"string"==typeof e&&(e=Le(e)),"string"==typeof t&&(t=Le(t));var n={};return t.scheme?(n.scheme=t.scheme,t.authority&&(n.authority=t.authority),t.path&&(n.path=Ke(t.path)),void 0!==t.query&&(n.query=t.query),void 0!==t.fragment&&(n.fragment=t.fragment)):t.authority?(e.scheme&&(n.scheme=e.scheme),n.authority=t.authority,t.path&&(n.path=Ke(t.path)),void 0!==t.query&&(n.query=t.query),void 0!==t.fragment&&(n.fragment=t.fragment)):t.path&&t.path.length?"/"===t.path[0]?(e.scheme&&(n.scheme=e.scheme),e.authority&&(n.authority=e.authority),t.path&&(n.path=Ke(t.path)),void 0!==t.query&&(n.query=t.query),void 0!==t.fragment&&(n.fragment=t.fragment)):(e.scheme&&(n.scheme=e.scheme),e.authority&&(n.authority=e.authority),n.path=Ke(_e(e,t.path)),void 0!==t.query&&(n.query=t.query),void 0!==t.fragment&&(n.fragment=t.fragment)):(e.scheme&&(n.scheme=e.scheme),e.authority&&(n.authority=e.authority),e.path&&(n.path=e.path),void 0!==t.query?n.query=t.query:void 0!==e.query&&(n.query=e.query),void 0!==t.fragment&&(n.fragment=t.fragment)),n}function _e(e,t){if(!e.authority||e.path&&e.path.length)return e.path&&e.path.length?He(e.path.slice(),t):t;var n=t.slice();return n.unshift("/"),n}function He(e,t){for(var n=[],i=e.shift();e.length>0;)n.push(i),i=e.shift();"/"===i&&n.push(i);for(var r=0,o=t.length;r<o;r+=1)n.push(t[r]);return n}function Ke(e){for(var t=[];e.length>0;){var n=e[0];if("."===n||".."===n)e=e.slice(e.length>1?2:1);else if("/"===n)if(e.length>1){var i=e[1];"."===i?e=e.length>2?e.slice(2):["/"]:".."===i?(e=e.length>2?e.slice(2):["/"],t.length>1&&"/"!==t[t.length-1]?t=t.slice(0,t.length-2):t.length>0&&(t=t.slice(0,t.length-1))):(t.push(n),t.push(i),e=e.slice(2))}else t.push("/"),e.shift();else t.push(n),e.shift()}return t}function We(e,t){if("string"==typeof e&&(e=Le(e)),"string"==typeof t&&(t=Le(t)),e.scheme!==t.scheme||!P(e.authority,t.authority))return t;var n={},i=e.path;i="string"==typeof i?Ne(i):i?i.slice():[];var r=t.path;"string"==typeof r?r=Ne(r):r||(r=[]);var o=Qe(i,r.slice(),r);return o.length>0&&(n.path=o),void 0!==t.query&&(n.query=t.query),void 0!==t.fragment&&(n.fragment=t.fragment),n}function Qe(e,t,n){return 0===e.length?(t.length>1&&t.shift(),t):"/"!==e[0]?t:0===t.length||"/"!==t[0]?(t.unshift("/"),t):(e.shift(),t.shift(),e.length>0&&0===t.length?["/"]:0===e.length||0===t.length||e[0]!==t[0]?t:(e.shift(),t.shift(),e.length>0&&0===t.length?n:Qe(e,t,n)))}function Xe(e){this.builder=e||new H}var Je=n(4);N.prototype.appendItem=function(e){a(e)?this.appendFields(e):this.appendValue(e)},N.prototype.appendFields=function(e){for(var t=Object.keys(e),n=0,i=t.length;n<i;n+=1){var r=t[n],o=e[r];this.appendField(r,o)}},N.prototype.appendField=function(e,t){var n={};"string"==typeof e?(n[e]=t,this.items.push(n),this.items[e]=t):(n.$key=e,n.$value=t,this.items.push(n))},N.prototype.appendValue=function(e){this.items.push(e)},N.prototype.appendRecord=function(e){for(var t=0,n=e.length;t<n;t+=1)this.appendItem(e[t])},N.prototype.state=function(){return this.items},V.prototype.appendItem=function(e){a(e)?this.appendField(e):this.appendValue(e)},V.prototype.appendFields=function(e){for(var t=Object.keys(e),n=0,i=t.length;n<i;n+=1){var r=t[n],o=e[r];this.appendField(r,o)}},V.prototype.appendField=function(e,t){null===this.items&&(this.items=[],null!==this.value&&(this.items.push(this.value),this.value=null));var n={};"string"==typeof e?(n[e]=t,this.items.push(n),this.items[e]=t):(n.$key=e,n.$value=t,this.items.push(n))},V.prototype.appendValue=function(e){null!==this.items?this.items.push(e):null===this.value?this.value=e:(this.items=[],this.items.push(this.value),this.value=null,this.items.push(e))},V.prototype.state=function(){return null!==this.value?this.value:null!==this.items?this.items:void 0},$.prototype.isDone=function(){return this.isEmpty()&&!this.more},$.prototype.isEmpty=function(){return this.index>=this.string.length},$.prototype.head=function(){var e=this.string.charCodeAt(this.index);if(e<=55295||e>=57344)return e;if(e<=56319&&this.index+1<this.string.length){var t=this.string.charCodeAt(this.index+1);return t>=56320&&t<=57343?((1023&e)<<10|1023&t)+65536:65533}return 65533},$.prototype.step=function(){var e=this.string.charCodeAt(this.index);if(e<=55295||e>=57344)this.index+=1;else if(e<=56319&&this.index+1<this.string.length){var t=this.string.charCodeAt(this.index+1);t>=56320&&t<=57343?this.index+=2:this.index+=1}else this.index+=1},$.prototype.dup=function(){return new $(this.string,this.index,this.more)},$.Done={isDone:function(){return!0},isEmpty:function(){return!0},head:function(){throw"head of empty iterator"},step:function(){throw"empty iterator step"}},$.Done.prototype=Object.create($.prototype),_.prototype.isCont=function(){return!0},_.prototype.isDone=function(){return!1},_.prototype.isError=function(){return!1},_.prototype.feed=function(e){return this},_.prototype.run=function(e){var t=this;do t=t.feed(e);while(!e.isEmpty()&&t.isCont());return e.isEmpty()&&!e.isDone()&&t.isCont()&&(t=t.feed($.Done)),t},_.prototype.state=function(){},_.Done=function(e){_.call(this),this.value=e},_.Done.prototype=Object.create(_.prototype),_.Done.prototype.constructor=_.Done,_.Done.prototype.isCont=function(){return!1},_.Done.prototype.isDone=function(){return!0},_.Done.prototype.feed=function(e){return this},_.Done.prototype.state=function(){return this.value},_.Error=function(e){_.call(this),"number"==typeof e.found&&(e.found=String.fromCharCode(e.found)),this.error=e},_.Error.prototype=Object.create(_.prototype),_.Error.prototype.constructor=_.Error,_.Error.prototype.isCont=function(){return!1},_.Error.prototype.isError=function(){return!0},_.Error.prototype.feed=function(e){return this},_.Error.prototype.state=function(){throw this.error},_.unexpectedEOF=new _.Error("unexpected end of input"),H.prototype.append=function(e){if(e>=0&&e<=55295||e>=57344&&e<=65535)this.string+=String.fromCharCode(e);else if(e>=65536&&e<=1114111){var t=e-65536;this.string+=String.fromCharCode(55296|t>>>10,56320|1023&t)}else this.string+=String.fromCharCode(65533)},H.prototype.appendString=function(e){for(var t=new $(e);!t.isEmpty();)this.append(t.head()),t.step()},H.prototype.state=function(){return this.string},K.prototype.prepare=function(e){function t(e,t){var n=Math.max(e,t)-1;return n|=n>>1,n|=n>>2,n|=n>>4,n|=n>>8,n+1}if(this.aliased||e>this.buffer.length){var n=new Uint8Array(t(256,e));this.buffer&&n.set(this.buffer),this.buffer=n,this.aliased=!1}},K.prototype.appendByte=function(e){this.prepare(this.offset+1),this.buffer[this.offset]=e,this.offset+=1},K.prototype.decodeBase64Digit=function(e){return e>=65&&e<=90?e-65:e>=97&&e<=122?e-71:e>=48&&e<=57?e+4:43===e||45===e?62:47===e||95===e?63:void 0},K.prototype.decodeBase64Quantum=function(){var e=this.decodeBase64Digit(this.p),t=this.decodeBase64Digit(this.q);if(61!==this.r){var n=this.decodeBase64Digit(this.r);if(61!==this.s){var i=this.decodeBase64Digit(this.s);this.appendByte(e<<2|t>>>4),this.appendByte(t<<4|n>>>2),this.appendByte(n<<6|i)}else this.appendByte(e<<2|t>>>4),this.appendByte(t<<4|n>>>2)}else{if(61!==this.s)throw"incomplete base64 quantum";this.appendByte(e<<2|t>>>4)}},K.prototype.appendBase64Char=function(e){0===this.p?this.p=e:0===this.q?this.q=e:0===this.r?this.r=e:(this.s=e,this.decodeBase64Quantum(),this.s=0,this.r=0,this.q=0,this.p=0)},K.prototype.state=function(e){if(this.buffer){if(this.buffer.length!==this.offset){var t=new Uint8Array(this.offset);t.set(this.buffer.subarray(0,this.offset)),this.buffer=t}}else this.buffer=new Uint8Array(0);return this.aliased=!0,this.buffer},Z.prototype=Object.create(_.prototype),Z.prototype.constructor=Z,Z.prototype.feed=function(e){for(var t=this.value;(!e.isEmpty()||e.isDone())&&t.isCont();)t=t.feed(e);if(t.isError())return t;if(t.isDone()){if(!e.isEmpty())return new _.Error({found:e.head()});if(e.isDone())return t}return new Z(t)},ee.prototype=Object.create(_.prototype),ee.prototype.constructor=ee,ee.prototype.feed=function(e){for(var t=0,n=this.s,i=this.value,r=this.key,o=this.builder||new V;!e.isEmpty()||e.isDone();){if(1===n){for(;!e.isEmpty()&&(t=e.head(),X(t));)e.step();if(e.isEmpty()){if(e.isDone())return new _.Done(o.state())}else{if(!(64===t||123===t||91===t||J(t)||34===t||45===t||t>=48&&t<=57||37===t))return new _.Error({expected:"block value",found:t});n=2}}if(2===n){for(r=r||new ne;(!e.isEmpty()||e.isDone())&&r.isCont();)r=r.feed(e);if(r.isDone())n=3;else if(r.isError())return r}if(3===n){for(;!e.isEmpty()&&(t=e.head(),W(t));)e.step();if(e.isEmpty()){if(e.isDone())return o.appendValue(r.state()),new _.Done(o.state())}else 58===t?(e.step(),n=4):(o.appendValue(r.state()),r=null,n=6)}if(4===n){for(;!e.isEmpty()&&W(e.head());)e.step();if(e.isEmpty()){if(e.isDone())return o.appendField(r.state(),null),new _.Done(o.state())}else n=5}if(5===n){for(i=i||new ne;(!e.isEmpty()||e.isDone())&&i.isCont();)i=i.feed(e);if(i.isDone())o.appendField(r.state(),i.state()),r=null,i=null,n=6;else if(i.isError())return i}if(6===n){for(;!e.isEmpty()&&(t=e.head(),W(t));)e.step();if(e.isEmpty()){if(e.isDone())return new _.Done(o.state())}else{if(44!==t&&59!==t&&!Q(t))return new _.Done(o.state());e.step(),n=1}}}return new ee(o,r,i,n)},te.prototype=Object.create(_.prototype),te.prototype.constructor=te,te.prototype.feed=function(e){var t,n=0,i=this.s,r=this.value,o=this.ident;if(1===i)if(e.isEmpty()||(n=e.head(),64!==n)){if(!e.isEmpty())return new _.Error({expected:"'@'",found:n});if(e.isDone())return _.unexpectedEOF}else e.step(),i=2;if(2===i)if(o||(o=new se(new H("@"))),o=o.feed(e),o.isDone())i=3;else if(o.isError())return o;if(3===i)if(e.isEmpty()||40!==e.head()){if(!e.isEmpty()||e.isDone())return t={},t[o.state()]=null,new _.Done(t)}else e.step(),i=4;if(4===i){for(;!e.isEmpty()&&(n=e.head(),X(n));)e.step();if(e.isEmpty()){if(e.isDone())return _.unexpectedEOF}else{if(41===n)return e.step(),t={},t[o.state()]=null,new _.Done(t);i=5}}if(5===i){for(;(!e.isEmpty()||e.isDone())&&r.isCont();)r=r.feed(e);if(r.isDone())i=6;else if(r.isError())return r}if(6===i){for(;!e.isEmpty()&&(n=e.head(),X(n));)e.step();if(!e.isEmpty())return 41===n?(e.step(),t={},t[o.state()]=r.state(),new _.Done(t)):new _.Error({expected:"')'",found:n});if(e.isDone())return _.unexpectedEOF}return new te(o,r,i)},ne.prototype=Object.create(_.prototype),ne.prototype.constructor=ne,ne.prototype.feed=function(e){for(var t=0,n=this.s,i=this.value,r=this.field,o=this.builder;!e.isEmpty()||e.isDone();){if(1===n)if(e.isEmpty()){if(e.isDone())return o?new _.Done(o.state()):new _.Done(void 0)}else if(t=e.head(),64===t)r=new te,n=2;else if(123===t)o=o||new N,i=new re(o),n=5;else if(91===t)o=o||new N,i=new oe(o),n=5;else if(J(t))i=new se,n=4;else if(34===t)i=new pe,n=4;else if(45===t||t>=48&&t<=57)i=new ae,n=4;else{if(37!==t)return o?new _.Done(o.state()):new _.Done(void 0);i=new ue,n=4}if(2===n){for(;(!e.isEmpty()||e.isDone())&&r.isCont();)r=r.feed(e);if(r.isDone())o=o||new V,o.appendFields(r.state()),r=null,n=3;else if(r.isError())return r}if(3===n){for(;!e.isEmpty()&&W(e.head());)e.step();if(e.isEmpty()){if(e.isDone())return new _.Done(o.state())}else n=1}if(4===n){for(;(!e.isEmpty()||e.isDone())&&i.isCont();)i=i.feed(e);if(i.isDone())o=o||new V,o.appendValue(i.state()),i=null,n=6;else if(i.isError())return i}if(5===n){for(;(!e.isEmpty()||e.isDone())&&i.isCont();)i=i.feed(e);if(i.isDone())i=null,n=6;else if(i.isError())return i}if(6===n){for(;!e.isEmpty()&&W(e.head());)e.step();if(e.isEmpty()||64!==e.head())return new _.Done(o.state());n=1}}return new ne(o,r,i,n)},ie.prototype=Object.create(_.prototype),ie.prototype.constructor=ie,ie.prototype.feed=function(e){var t=0,n=this.s,i=this.value,r=this.field,o=this.builder;if(1===n)if(e.isEmpty()){if(e.isDone())return o?new _.Done(o.state()):new _.Done(null)}else if(t=e.head(),64===t)r=new te,n=2;else if(123===t)o?(i=new re(o),n=5):(i=new re,n=4);else{if(91!==t)return o?new _.Done(o.state()):new _.Done(null);o?(i=new oe(o),n=5):(i=new oe,n=4)}if(2===n){for(;(!e.isEmpty()||e.isDone())&&r.isCont();)r=r.feed(e);if(r.isDone())o=o||new V,o.appendFields(r.state()),r=null,n=3;else if(r.isError())return r}if(3===n)if(e.isEmpty()){if(e.isDone())return new _.Done(o.state())}else if(t=e.head(),123===t)i=new re(o),n=5;else{if(91!==t)return new _.Done(o.state());i=new oe(o),n=5}if(4===n){for(;(!e.isEmpty()||e.isDone())&&i.isCont();)i=i.feed(e);if(i.isDone())return o=o||new V,o.appendValue(i.state()),new _.Done(o.state());if(i.isError())return i}if(5===n){for(;(!e.isEmpty()||e.isDone())&&i.isCont();)i=i.feed(e);if(i.isDone())return new _.Done(o.state());if(i.isError())return i}return new ie(o,r,i,n)},re.prototype=Object.create(_.prototype),re.prototype.constructor=re,re.prototype.feed=function(e){var t=0,n=this.s,i=this.value,r=this.key,o=this.builder||new N;if(1===n)if(e.isEmpty()){if(e.isDone())return _.unexpectedEOF}else{if(t=e.head(),123!==t)return new _.Error({expected:"'{'",found:t});e.step(),n=2}for(;!e.isEmpty()||e.isDone();){if(2===n){for(;!e.isEmpty()&&(t=e.head(),X(t));)e.step();if(e.isEmpty()){if(e.isDone())return _.unexpectedEOF}else{if(125===t)return e.step(),new _.Done(o.state());n=3}}if(3===n){for(r=r||new ne;(!e.isEmpty()||e.isDone())&&r.isCont();)r=r.feed(e);if(r.isDone())n=4;else if(r.isError())return r}if(4===n){for(;!e.isEmpty()&&(t=e.head(),W(t));)e.step();if(e.isEmpty()){if(e.isDone())return o.appendValue(r.state()),new _.Done(o.state())}else 58===t?(e.step(),n=5):(o.appendValue(r.state()),r=null,n=7)}if(5===n){for(;!e.isEmpty()&&W(e.head());)e.step();if(e.isEmpty()){if(e.isDone())return o.appendField(r,null),new _.Done(o.state())}else n=6}if(6===n){for(i=i||new ne;(!e.isEmpty()||e.isDone())&&i.isCont();)i=i.feed(e);if(i.isDone())o.appendField(r.state(),i.state()),r=null,i=null,n=7;else if(i.isError())return i}if(7===n){for(;!e.isEmpty()&&(t=e.head(),W(t));)e.step();if(e.isEmpty()){if(e.isDone())return _.unexpectedEOF}else{if(44!==t&&59!==t&&!Q(t))return 125===t?(e.step(),new _.Done(o.state())):new _.Error({expected:"'}', ';', ',', or newline",found:t});e.step(),n=2}}}return new re(o,r,i,n)},oe.prototype=Object.create(_.prototype),oe.prototype.constructor=oe,oe.prototype.feed=function(e){var t=0,n=this.s,i=this.value,r=this.text,o=this.builder;if(1===n)if(e.isEmpty()){if(e.isDone())return _.unexpectedEOF;
}else{if(t=e.head(),91!==t)return new _.Error({expected:"'['",found:t});e.step(),n=2}for(;!e.isEmpty()||e.isDone();){if(2===n){for(;!e.isEmpty()&&(t=e.head(),64!==t&&91!==t&&92!==t&&93!==t&&123!==t&&125!==t);)e.step(),r=r||new H,r.append(t);if(e.isEmpty()){if(e.isDone())return _.unexpectedEOF}else{if(93===t)return e.step(),o=o||new N,r&&o.appendValue(r.state()),new _.Done(o.state());64===t?(o=o||new N,r&&(o.appendValue(r.state()),r=null),i=new ie,n=3):123===t?(o=o||new N,r&&(o.appendValue(r.state()),r=null),i=new re(o),n=4):91===t?(o=o||new N,r&&(o.appendValue(r.state()),r=null),i=new oe(o),n=4):92===t?(e.step(),n=5):new _.Error({found:t})}}if(3===n){for(;(!e.isEmpty()||e.isDone())&&i.isCont();)i=i.feed(e);if(i.isDone())o.appendValue(i.state()),i=null,n=2;else if(i.isError())return i}if(4===n){for(;(!e.isEmpty()||e.isDone())&&i.isCont();)i=i.feed(e);if(i.isDone())i=null,n=2;else if(i.isError())return i}if(5===n)if(e.isEmpty()){if(e.isDone())return _.unexpectedEOF}else if(t=e.head(),r=r||new H,34===t||47===t||64===t||91===t||92===t||93===t||123===t||125===t)e.step(),r.append(t),n=2;else if(98===t)e.step(),r.append(8),n=2;else if(102===t)e.step(),r.append(12),n=2;else if(110===t)e.step(),r.append(10),n=2;else if(114===t)e.step(),r.append(13),n=2;else{if(116!==t)return new _.Error({expected:"escape character",found:t});e.step(),r.append(9),n=2}}return new oe(o,r,i,n)},se.prototype=Object.create(_.prototype),se.prototype.constructor=se,se.prototype.feed=function(e){var t=0,n=this.s,i=this.builder;if(1===n)if(!e.isEmpty()&&(t=e.head(),J(t)))i=i||new H,e.step(),i.append(t),n=2;else{if(!e.isEmpty())return new _.Error({expected:"identitifer",found:t});if(e.isDone())return _.unexpectedEOF}if(2===n){for(;!e.isEmpty()&&(t=e.head(),G(t));)e.step(),i.append(t);if(!e.isEmpty()||e.isDone()){var r=i.state();return"true"===r?r=!0:"false"===r&&(r=!1),new _.Done(r)}}return new se(i,n)},pe.prototype=Object.create(_.prototype),pe.prototype.constructor=pe,pe.prototype.feed=function(e){var t=0,n=this.s,i=this.text;if(1===n)if(e.isEmpty()||(t=e.head(),34!==t)){if(!e.isEmpty())return new _.Error({expected:"'\"'",found:t});if(e.isDone())return _.unexpectedEOF}else e.step(),n=2;for(;!e.isEmpty()||e.isDone();){if(2===n){for(i=i||new H;!e.isEmpty()&&(t=e.head(),34!==t&&92!==t);)e.step(),i.append(t);if(e.isEmpty()){if(e.isDone())return _.unexpectedEOF}else{if(34===t)return e.step(),new _.Done(i.state());92===t&&(e.step(),n=3)}}if(3===n)if(e.isEmpty()){if(e.isDone())return _.unexpectedEOF}else if(t=e.head(),34===t||47===t||64===t||91===t||92===t||93===t||123===t||125===t)e.step(),i.append(t),n=2;else if(98===t)e.step(),i.append(8),n=2;else if(102===t)e.step(),i.append(12),n=2;else if(110===t)e.step(),i.append(10),n=2;else if(114===t)e.step(),i.append(13),n=2;else{if(116!==t)return new _.Error({expected:"escape character",found:t});e.step(),i.append(9),n=2}}return new pe(i,n)},ae.prototype=Object.create(_.prototype),ae.prototype.constructor=ae,ae.prototype.feed=function(e){var t=0,n=this.s,i=this.builder||new H;if(1===n)if(e.isEmpty()){if(e.isDone())return _.unexpectedEOF}else t=e.head(),45===t&&(e.step(),i.append(t)),n=2;if(2===n)if(e.isEmpty()){if(e.isDone())return _.unexpectedEOF}else if(t=e.head(),48===t)e.step(),i.append(t),n=4;else{if(!(t>=49&&t<=57))return new _.Error({expected:"digit",found:t});e.step(),i.append(t),n=3}if(3===n){for(;!e.isEmpty()&&(t=e.head(),t>=48&&t<=57);)e.step(),i.append(t);if(e.isEmpty()){if(e.isDone())return new _.Done(Number(i.state()))}else n=4}if(4===n)if(e.isEmpty()){if(e.isDone())return new _.Done(Number(i.state()))}else if(t=e.head(),46===t)e.step(),i.append(t),n=5;else{if(69!==t&&101!==t)return new _.Done(Number(i.state()));e.step(),i.append(t),n=8}if(5===n)if(e.isEmpty()){if(e.isDone())return _.unexpectedEOF}else{if(t=e.head(),!(t>=48&&t<=57))return new _.Error({expected:"digit",found:t});e.step(),i.append(t),n=6}if(6===n){for(;!e.isEmpty()&&(t=e.head(),t>=48&&t<=57);)e.step(),i.append(t);if(e.isEmpty()){if(e.isDone())return new _.Done(Number(i.state()))}else n=7}if(7===n){if(t=e.head(),69!==t&&101!==t)return new _.Done(Number(i.state()));e.step(),i.append(t),n=8}if(8===n)if(e.isEmpty()){if(e.isDone())return _.unexpectedEOF}else t=e.head(),43!==t&&45!==t||(e.step(),i.append(t)),n=9;if(9===n)if(e.isEmpty()){if(e.isDone())return _.unexpectedEOF}else{if(t=e.head(),!(t>=48&&t<=57))return new _.Error({expected:"digit",found:t});e.step(),i.append(t),n=10}if(10===n){for(;!e.isEmpty()&&(t=e.head(),t>=48&&t<=57);)e.step(),i.append(t);if(!e.isEmpty()||e.isDone())return new _.Done(Number(i.state()))}return new ae(i,n)},ue.prototype=Object.create(_.prototype),ue.prototype.constructor=ue,ue.prototype.feed=function(e){var t=0,n=this.s,i=this.data||new K;if(1===n)if(e.isEmpty()||(t=e.head(),37!==t)){if(!e.isEmpty())return new _.Error({expected:"'%'",found:t});if(e.isDone())return _.unexpectedEOF}else e.step(),n=2;for(;!e.isEmpty()||e.isDone();){if(2===n)if(!e.isEmpty()&&(t=e.head(),Y(t)))e.step(),i.appendBase64Char(t),n=3;else if(!e.isEmpty()||e.isDone())return new _.Done(i.state());if(3===n)if(!e.isEmpty()&&(t=e.head(),Y(t)))e.step(),i.appendBase64Char(t),n=4;else{if(!e.isEmpty())return new _.Error({expected:"base64 digit",found:t});if(e.isDone())return _.unexpectedEOF}if(4===n)if(!e.isEmpty()&&(t=e.head(),Y(t)||61===t))e.step(),i.appendBase64Char(t),n=61!==t?5:6;else{if(!e.isEmpty())return new _.Error({expected:"base64 digit",found:t});if(e.isDone())return _.unexpectedEOF}if(5===n)if(!e.isEmpty()&&(t=e.head(),Y(t)||61===t)){if(e.step(),i.appendBase64Char(t),61===t)return new _.Done(i.state());n=2}else{if(!e.isEmpty())return new _.Error({expected:"base64 digit",found:t});if(e.isDone())return _.unexpectedEOF}else if(6===n){if(!e.isEmpty()&&(t=e.head(),61===t))return e.step(),i.appendBase64Char(t),new _.Done(i.state());if(!e.isEmpty())return new _.Error({expected:"'='",found:t});if(e.isDone())return _.unexpectedEOF}}return new ue(i,n)},he.prototype.writeValue=function(e){"string"==typeof e?this.writeText(e):"number"==typeof e?this.writeNumber(e):"boolean"==typeof e?this.writeBool(e):e instanceof Uint8Array?this.writeData(e):s(e)?this.writeRecord(e):p(e)&&this.writeRecord(T(e))},he.prototype.writeItem=function(e){a(e)?this.writeSlots(e):this.writeValue(e)},he.prototype.writeAttrs=function(e){for(var t=Object.keys(e),n=0,i=t.length;n<i;n+=1){var r=t[n];if(r.length>0&&64===r.charCodeAt(0)){var o=e[r];this.writeAttr(r.substring(1),o)}}},he.prototype.writeAttr=function(e,t){this.builder.append(64),this.writeIdent(e),null!==t&&(this.builder.append(40),this.writeBlock(t),this.builder.append(41))},he.prototype.writeSlots=function(e){var t,n,i=Object.keys(e),r=i.length;if(2===r&&void 0!==e.$key&&void 0!==e.$value)t=e.$key,n=e.$value,this.writeSlot(t,n);else for(var o=0;o<r;o+=1)t=i[o],n=e[t],o>0&&this.builder.append(44),this.writeSlot(t,n)},he.prototype.writeSlot=function(e,t){this.writeValue(e),this.builder.append(58),null!==t&&this.writeValue(t)},he.prototype.writeBlock=function(e){p(e)?(s(e)||(e=T(e)),e.length>0?this.writeItems(e,h(e),!1):(this.builder.append(123),this.builder.append(125))):this.writeValue(e)},he.prototype.writeRecord=function(e){e.length>0?this.writeItems(e,!1,!1):(this.builder.append(123),this.builder.append(125))},he.prototype.writeItems=function(e,t,n){for(var i=0,r=e.length,o=!1,p=!1,h=!0;i<r;){var c=e[i];i+=1,p&&u(c)&&(o&&(this.builder.append(125),o=!1),this.builder.append(93),p=!1),u(c)?(o?(this.builder.append(125),o=!1):p&&(this.builder.append(93),p=!1),this.writeAttrs(c),h=!1):p&&"string"==typeof c?(o&&(this.builder.append(125),o=!1),this.writeMarkupText(c)):o?(h?h=!1:this.builder.append(44),this.writeItem(c)):p?s(c)&&l(c)?(this.writeItems(c,!1,!0),i<r&&"string"==typeof e[i]?(this.writeMarkupText(e[i]),i+=1):i<r&&!u(e[i])?(this.builder.append(123),o=!0,h=!0):(this.builder.append(93),p=!1)):(this.builder.append(123),this.writeItem(c),o=!0,h=!1):"string"==typeof c&&i<r&&!a(e[i])&&"string"!=typeof e[i]&&"boolean"!=typeof e[i]?(this.builder.append(91),this.writeMarkupText(c),p=!0):t&&!o?(h?h=!1:this.builder.append(44),this.writeItem(c)):n&&"string"==typeof c&&i>=r?(this.builder.append(91),this.writeMarkupText(c),this.builder.append(93)):n||a(c)||s(c)||!(!h&&i>=r||i<r&&u(e[i]))?(this.builder.append(123),this.writeItem(c),o=!0,h=!1):(!h&&("string"==typeof c&&this.isIdent(c)||"number"==typeof c||"boolean"==typeof c)&&this.builder.append(32),this.writeValue(c))}o&&this.builder.append(125),p&&this.builder.append(93)},he.prototype.isIdent=function(e){var t=new $(e);if(t.isEmpty()||!J(t.head()))return!1;for(t.step();!t.isEmpty()&&G(t.head());)t.step();return t.isEmpty()},he.prototype.writeText=function(e){this.isIdent(e)?this.writeIdent(e):this.writeString(e)},he.prototype.writeIdent=function(e){this.builder.appendString(e)},he.prototype.writeString=function(e){var t=new $(e);for(this.builder.append(34);!t.isEmpty();){var n=t.head();switch(n){case 34:case 92:this.builder.append(92),this.builder.append(n);break;case 8:this.builder.append(92),this.builder.append(98);break;case 12:this.builder.append(92),this.builder.append(102);break;case 10:this.builder.append(92),this.builder.append(110);break;case 13:this.builder.append(92),this.builder.append(114);break;case 9:this.builder.append(92),this.builder.append(116);break;default:this.builder.append(n)}t.step()}this.builder.append(34)},he.prototype.writeMarkupText=function(e){for(var t=new $(e);!t.isEmpty();){var n=t.head();switch(n){case 64:case 91:case 92:case 93:case 123:case 125:this.builder.append(92),this.builder.append(n);break;case 8:this.builder.append(92),this.builder.append(98);break;case 12:this.builder.append(92),this.builder.append(102);break;case 10:this.builder.append(92),this.builder.append(110);break;case 13:this.builder.append(92),this.builder.append(114);break;case 9:this.builder.append(92),this.builder.append(116);break;default:this.builder.append(n)}t.step()}},he.prototype.writeNumber=function(e){this.builder.appendString(e.toString())},he.prototype.writeBool=function(e){this.builder.appendString(e.toString())},he.prototype.writeData=function(e){function t(e){return e>=0&&e<26?e+65:e>=26&&e<52?e+71:e>=52&&e<62?e-4:62===e?43:63===e?47:void 0}this.builder.append(37);for(var n,i,r,o=0,s=e.length;o+2<s;)n=e[o],i=e[o+1],r=e[o+2],this.builder.append(t(n>>>2)),this.builder.append(t(63&(n<<4|i>>>4))),this.builder.append(t(63&(i<<2|r>>>6))),this.builder.append(t(63&r)),o+=3;o+1<s?(n=e[o],i=e[o+1],this.builder.append(t(n>>>2)),this.builder.append(t(63&(n<<4|i>>>4))),this.builder.append(t(i<<2&63)),this.builder.append(61),o+=2):o<s&&(n=e[o],this.builder.append(t(n>>>2)),this.builder.append(t(n<<4&63)),this.builder.append(61),this.builder.append(61),o+=1)},he.prototype.state=function(){return this.builder.state()},Pe.prototype=Object.create(_.prototype),Pe.prototype.constructor=Pe,Pe.prototype.feed=function(e){var t,n=0,i=this.s,r=this.fragment,o=this.query,s=this.path,p=this.authority,a=this.scheme;if(1===i)if(e.isEmpty())e.isDone()&&(i=3);else{for(var u=e.dup();!u.isEmpty()&&(n=u.head(),fe(n));)u.step();i=u.isEmpty()||58!==n?3:2}if(2===i){if(a=a||new Ue,a=a.feed(e),a.isError())return a;if(e.isEmpty()||(n=e.head(),58!==n)){if(!e.isEmpty())return new _.Error({expected:"':'",found:n});if(e.isDone())return _.unexpectedEOF}else e.step(),i=3}if(3===i)if(e.isEmpty()){if(e.isDone())return t={},a&&(t.scheme=a.state()),new _.Done(t)}else n=e.head(),47===n?(e.step(),i=4):63===n?(e.step(),i=7):35===n?(e.step(),i=8):i=6;if(4===i)if(e.isEmpty()||(n=e.head(),47!==n))if(e.isEmpty()){if(e.isDone())return t={},a&&(t.scheme=a.state()),t.path=["/"],new _.Done(t)}else s=new Fe(["/"]),i=6;else e.step(),i=5;if(5===i){if(p=p||new Ae,p=p.feed(e),p.isError())return p;if(e.isEmpty()){if(e.isDone())return t={},a&&(t.scheme=a.state()),p.state()&&(t.authority=p.state()),new _.Done(t)}else n=e.head(),63===n?(e.step(),i=7):35===n?(e.step(),i=8):i=6}if(6===i){if(s=s||new Fe,s=s.feed(e),s.isError())return s;if(e.isEmpty()){if(e.isDone())return t={},a&&(t.scheme=a.state()),p&&(t.authority=p.state()),t.path=s.state(),new _.Done(t)}else if(n=e.head(),63===n)e.step(),i=7;else{if(35!==n)return t={},a&&(t.scheme=a.state()),p&&(t.authority=p.state()),t.path=s.state(),new _.Done(t);e.step(),i=8}}if(7===i){if(o=o||new Be,o=o.feed(e),o.isError())return o;if(e.isEmpty()){if(e.isDone())return t={},a&&(t.scheme=a.state()),p&&(t.authority=p.state()),s&&(t.path=s.state()),t.query=o.state(),new _.Done(t)}else{if(n=e.head(),35!==n)return t={},a&&(t.scheme=a.state()),p&&(t.authority=p.state()),t.path=s.state(),t.query=o.state(),new _.Done(t);e.step(),i=8}}if(8===i){if(r=r||new ze,r=r.feed(e),r.isError())return r;if(e.isDone())return t={},a&&(t.scheme=a.state()),p&&(t.authority=p.state()),s&&(t.path=s.state()),o&&(t.query=o.state()),t.fragment=r.state(),new _.Done(t)}return new Pe(a,p,s,o,r,i)},Pe.prototype.state=function(){var e=this.scheme.state(),t=this.authority.state(),n=this.path.state(),i=this.query.state(),r=this.fragment.state(),o={};return void 0!==e&&(o.scheme=e),t&&(o.authority=t),n&&(o.path=n),i&&(o.query=i),void 0!==r&&(o.fragment=r),o},Ue.prototype=Object.create(_.prototype),Ue.prototype.constructor=Ue,Ue.prototype.feed=function(e){var t=0,n=this.s,i=this.builder||new H;if(1===n)if(!e.isEmpty()&&(t=e.head(),Ee(t)))e.step(),i.append(xe(t)),n=2;else if(!e.isEmpty()||e.isDone())return new _.Error({expected:"scheme",found:t});if(2===n){for(;!e.isEmpty()&&(t=e.head(),fe(t));)e.step(),i.append(xe(t));if(!e.isEmpty()||e.isDone())return new _.Done(i.state())}return new Ue(i,n)},Ue.prototype.state=function(){if(this.builder)return this.builder.state()},Ae.prototype=Object.create(_.prototype),Ae.prototype.constructor=Ae,Ae.prototype.feed=function(e){var t,n,i,r=0,o=this.s,s=this.port,p=this.host,a=this.userInfo;if(1===o)if(e.isEmpty())e.isDone()&&(o=3);else{for(var u=e.dup();!u.isEmpty()&&(r=u.head(),64!==r&&47!==r);)u.step();o=u.isEmpty()||64!==r?3:2}if(2===o){if(a=a||new Re,a=a.feed(e),a.isError())return a;if(e.isEmpty()||(r=e.head(),64!==r)){if(!e.isEmpty())return new _.Error({expected:64,found:r});if(e.isDone())return _.unexpectedEOF()}else e.step(),o=3}if(3===o){if(p=p||new Se,p=p.feed(e),p.isError())return p;if(e.isEmpty()||58!==e.head()){if(!e.isEmpty()||e.isDone())return p.state()?(t={},n=p.state(),void 0!==n.name&&(t.host=n.name),void 0!==n.ipv4&&(t.ipv4=n.ipv4),void 0!==n.ipv6&&(t.ipv6=n.ipv6),a&&(i=a.state(),"string"==typeof i?t.userInfo=i:i&&(t.username=i.username,t.password=i.password)),new _.Done(t)):a?(t={},i=a.state(),"string"==typeof i?t.userInfo=i:i&&(t.username=i.username,t.password=i.password),new _.Done(t)):new _.Done(void 0)}else e.step(),o=4}if(4===o){if(s=s||new Me,s=s.feed(e),s.isError())return s;if(!e.isEmpty()||e.isDone())return t={},n=p.state(),void 0!==n.name&&(t.host=n.name),void 0!==n.ipv4&&(t.ipv4=n.ipv4),void 0!==n.ipv6&&(t.ipv6=n.ipv6),t.port=s.state(),a&&(i=a.state(),"string"==typeof i?t.userInfo=i:i&&(t.username=i.username,t.password=i.password)),new _.Done(t)}return new Ae(a,p,s,o)},Ae.prototype.state=function(){if(this.host&&this.host.state()){var e={},t=this.host.state();if(void 0!==t.name&&(e.host=t.name),void 0!==t.ipv4&&(e.ipv4=t.ipv4),void 0!==t.ipv6&&(e.ipv6=t.ipv6),this.port&&(e.port=this.port.state()),this.userInfo){var n=this.userInfo.state();"string"==typeof n?e.userInfo=n:n&&(e.username=n.username,e.password=n.password)}return e}},Re.prototype=Object.create(_.prototype),Re.prototype.constructor=Re,Re.prototype.feed=function(e){for(var t=0,n=this.s,i=this.c1,r=this.password,o=this.username;!e.isEmpty()||e.isDone();){if(1===n){for(o||e.isEmpty()||(o=new H);!e.isEmpty()&&(t=e.head(),ye(t));)e.step(),o.append(t);if(e.isEmpty()||58!==t)if(e.isEmpty()||37!==t){if(!e.isEmpty()||e.isDone())return new _.Done(o.state())}else e.step(),n=2;else e.step(),n=4}if(2===n)if(!e.isEmpty()&&(t=e.head(),Oe(t)))e.step(),i=t,n=3;else{if(!e.isEmpty())return new _.Error({expected:"hex digit",found:t});if(e.isDone())return _.unexpectedEOF}if(3===n)if(!e.isEmpty()&&(t=e.head(),Oe(t)))e.step(),o.append((je(i)<<4)+je(t)),i=0,n=1;else{if(!e.isEmpty())return new _.Error({expected:"hex digit",found:t});if(e.isDone())return _.unexpectedEOF}if(4===n){for(r=r||new H;!e.isEmpty()&&(t=e.head(),de(t));)e.step(),r.append(t);if(e.isEmpty()||37!==t){if(!e.isEmpty()||e.isDone()){var s={username:o.state(),password:r.state()};return new _.Done(s)}}else e.step(),n=5}if(5===n)if(!e.isEmpty()&&(t=e.head(),Oe(t)))e.step(),i=t,n=6;else{if(!e.isEmpty())return new _.Error({expected:"hex digit",found:t});if(e.isDone())return _.unexpectedEOF}if(6===n)if(!e.isEmpty()&&(t=e.head(),Oe(t)))e.step(),r.append((je(i)<<4)+je(t)),i=0,n=4;else{if(!e.isEmpty())return new _.Error({expected:"hex digit",found:t});if(e.isDone())return _.unexpectedEOF}}return new Re(o,r,i,n)},Re.prototype.state=function(){return this.password?{username:this.username.state(),password:this.password.state()}:this.username?this.username.state():void 0},Se.prototype=Object.create(_.prototype),Se.prototype.constructor=Se,Se.prototype.feed=function(e){if(!e.isEmpty()){var t=e.head();return 91===t?(new qe).feed(e):(new Ie).feed(e)}return this},Ie.prototype=Object.create(_.prototype),Ie.prototype.constructor=Ie,Ie.prototype.feed=function(e){for(var t,n=0,i=this.s,r=this.x,o=this.c1,s=this.builder;i<=4&&(!e.isEmpty()||e.isDone());){for(s=s||new H;!e.isEmpty()&&(n=e.head(),ke(n));)e.step(),s.append(n),r=10*r+De(n);if(e.isEmpty()){if(e.isDone())return 4===i&&r<=255?(t={ipv4:s.state()},new _.Done(t)):(t={name:s.state()},new _.Done(t))}else if(46===n&&i<4&&r<=255)e.step(),s.append(n),r=0,i+=1;else{if(!ve(n)&&37!==n&&4===i&&r<=255)return t={ipv4:s.state()},new _.Done(t);r=0,i=5}}for(;!e.isEmpty()||e.isDone();){if(5===i){for(;!e.isEmpty()&&(n=e.head(),ve(n));)e.step(),s.append(xe(n));if(e.isEmpty()||37!==n){if(!e.isEmpty()||e.isDone())return t={name:s.state()},new _.Done(t)}else e.step(),i=6}if(6===i)if(!e.isEmpty()&&(n=e.head(),Oe(n)))e.step(),o=n,i=7;else{if(!e.isEmpty())return new _.Error({expected:"hex digit",found:n});if(e.isDone())return _.unexpectedEOF}if(7===i)if(!e.isEmpty()&&(n=e.head(),Oe(n)))e.step(),s.append((je(o)<<4)+je(n)),o=0,i=5;else{if(!e.isEmpty())return new _.Error({expected:"hex digit",found:n});if(e.isDone())return _.unexpectedEOF}}return new Ie(s,o,r,i)},Ie.prototype.state=function(){if(this.builder)return 4===this.s&&this.x<=255?{ipv4:this.builder.state()}:{name:this.builder.state()}},qe.prototype=Object.create(_.prototype),qe.prototype.constructor=qe,qe.prototype.feed=function(e){var t=0,n=this.s,i=this.builder;if(1===n)if(e.isEmpty()||(t=e.head(),91!==t)){if(!e.isEmpty())return new _.Error({expected:"'['",found:t});if(e.isDone())return _.unexpectedEOF}else e.step(),n=2;if(2===n){for(i=i||new H;!e.isEmpty()&&(t=e.head(),ve(t)||58===t);)e.step(),i.append(xe(t));if(!e.isEmpty()&&93===t){e.step();var r={ipv6:i.state()};return new _.Done(r)}if(!e.isEmpty())return new _.Error({found:t});if(e.isDone())return _.unexpectedEOF}return new qe(i,n)},qe.prototype.state=function(){if(this.builder)return{ipv6:this.builder.state()}},Me.prototype=Object.create(_.prototype),Me.prototype.constructor=Me,Me.prototype.feed=function(e){for(var t=0,n=this.port;!e.isEmpty()&&(t=e.head(),ke(t));)e.step(),n=10*n+De(t);return!e.isEmpty()||e.isDone()?new _.Done(n):new Me(n)},Me.prototype.state=function(){if(0!==this.port)return this.port},Fe.prototype=Object.create(_.prototype),Fe.prototype.constructor=Fe,Fe.prototype.feed=function(e){for(var t=0,n=this.s,i=this.c1,r=this.builder,o=this.path;!e.isEmpty()||e.isDone();){if(1===n){for(;!e.isEmpty()&&(t=e.head(),me(t));)r=r||new H,e.step(),r.append(t);if(e.isEmpty()||47!==t)if(e.isEmpty()||37!==t){if(!e.isEmpty()||e.isDone())return o=o||[],r&&o.push(r.state()),new _.Done(o)}else e.step(),n=2;else e.step(),o=o||[],r&&(o.push(r.state()),r=null),o.push("/")}if(2===n)if(!e.isEmpty()&&(t=e.head(),Oe(t)))e.step(),i=t,n=3;else{if(!e.isEmpty())return new _.Error({expected:"hex digit",found:t});if(e.isDone())return _.unexpectedEOF}if(3===n)if(!e.isEmpty()&&(t=e.head(),Oe(t)))r=r||new H,e.step(),r.append((je(i)<<4)+je(t)),i=0,n=1;else{if(!e.isEmpty())return new _.Error({expected:"hex digit",found:t});if(e.isDone())return _.unexpectedEOF}}return new Fe(o,r,i,n)},Fe.prototype.state=function(){return this.path?this.path:[]},Be.prototype=Object.create(_.prototype),Be.prototype.constructor=Be,Be.prototype.feed=function(e){for(var t,n,i,r=0,o=this.s,s=this.c1,p=this.query,a=this.value,u=this.key;!e.isEmpty()||e.isDone();){if(1===o){for(u=u||new H;!e.isEmpty()&&(r=e.head(),ge(r));)e.step(),u.append(r);if(e.isEmpty()||61!==r)if(e.isEmpty()||38!==r)if(e.isEmpty()||37!==r){if(!e.isEmpty()||e.isDone())return p?(p.push(u.state()),new _.Done(p)):new _.Done(u.state())}else e.step(),o=2;else e.step(),p=p||[],p.push(u.state()),u=null,o=1;else e.step(),o=4}if(2===o)if(!e.isEmpty()&&(r=e.head(),Oe(r)))e.step(),s=r,o=3;else{if(!e.isEmpty())return new _.Error({expected:"hex digit",found:r});if(e.isDone())return _.unexpectedEOF}if(3===o)if(!e.isEmpty()&&(r=e.head(),Oe(r)))e.step(),u.append((je(s)<<4)+je(r)),s=0,o=1;else{if(!e.isEmpty())return new _.Error({expected:"hex digit",found:r});if(e.isDone())return _.unexpectedEOF}if(4===o){for(a=a||new H;!e.isEmpty()&&(r=e.head(),ge(r)||61===r);)e.step(),a.append(r);if(e.isEmpty()||38!==r)if(e.isEmpty()||38!==r){if(!e.isEmpty()||e.isDone())return t=u.state(),n=a.state(),i={},i[t]=n,p=p||[],p.push(i),p[t]=n,new _.Done(p)}else e.step(),o=5;else e.step(),t=u.state(),n=a.state(),i={},i[t]=n,p=p||[],p.push(i),p[t]=n,u=null,a=null,o=1}if(5===o)if(!e.isEmpty()&&(r=e.head(),Oe(r)))e.step(),s=r,o=6;else{if(!e.isEmpty())return new _.Error({expected:"hex digit",found:r});if(e.isDone())return _.unexpectedEOF}if(6===o)if(!e.isEmpty()&&(r=e.head(),Oe(r)))e.step(),a.append((je(s)<<4)+je(r)),s=0,o=4;else{if(!e.isEmpty())return new _.Error({expected:"hex digit",found:r});if(e.isDone())return _.unexpectedEOF}}return new Be(u,a,p,s,o)},Be.prototype.state=function(){if(this.query)return this.query},ze.prototype=Object.create(_.prototype),ze.prototype.constructor=ze,ze.prototype.feed=function(e){for(var t=0,n=this.s,i=this.c1,r=this.builder||new H;!e.isEmpty()||e.isDone();){if(1===n){for(;!e.isEmpty()&&(t=e.head(),we(t));)e.step(),r.append(t);if(e.isEmpty()||37!==t){if(!e.isEmpty()||e.isDone())return new _.Done(r.state())}else e.step(),n=2}if(2===n)if(!e.isEmpty()&&(t=e.head(),Oe(t)))e.step(),i=t,n=3;else{if(!e.isEmpty())return new _.Error({expected:"hex digit",found:t});if(e.isDone())return _.unexpectedEOF}if(3===n)if(!e.isEmpty()&&(t=e.head(),Oe(t)))e.step(),r.append((je(i)<<4)+je(t)),i=0,n=1;else{if(!e.isEmpty())return new _.Error({expected:"hex digit",found:t});if(e.isDone())return _.unexpectedEOF}}return new ze(r,i,n)},ze.prototype.state=function(){if(this.builder)return this.builder.state()},Xe.prototype.writeUri=function(e){e.scheme&&(this.writeScheme(e.scheme),this.builder.append(58)),e.authority&&(this.builder.append(47),this.builder.append(47),this.writeAuthority(e.authority)),e.path&&this.writePath(e.path),void 0!==e.query&&(this.builder.append(63),this.writeQuery(e.query)),void 0!==e.fragment&&(this.builder.append(35),this.writeFragment(e.fragment))},Xe.prototype.writeScheme=function(e){for(var t=new $(e);!t.isEmpty();){var n=t.head();if(!fe(n))throw"Invalid URI scheme: "+e;this.builder.append(n),t.step()}},Xe.prototype.writeAuthority=function(e){"string"==typeof e&&(e=Te(e)),void 0!==e.userInfo?(this.writeUserInfo(e.userInfo),this.builder.append(64)):void 0!==e.username&&void 0!==e.password&&(this.writeUser(e.username),this.builder.append(58),this.writeUserInfo(e.password),this.builder.append(64)),void 0!==e.host?this.writeHost(e.host):void 0!==e.ipv4?this.writeHost(e.ipv4):void 0!==e.ipv6&&(this.builder.append(91),this.writeHostLiteral(e.ipv6),this.builder.append(93)),e.port&&(this.builder.append(58),this.writePort(e.port))},Xe.prototype.writeUserInfo=function(e){for(var t=new $(e);!t.isEmpty();){var n=t.head();de(n)?this.builder.append(n):this.writeEncoded(n),t.step()}},Xe.prototype.writeUser=function(e){for(var t=new $(e);!t.isEmpty();){var n=t.head();ye(n)?this.builder.append(n):this.writeEncoded(n),t.step()}},Xe.prototype.writeHost=function(e){for(var t=new $(e);!t.isEmpty();){var n=t.head();ve(n)?this.builder.append(n):this.writeEncoded(n),t.step()}},Xe.prototype.writeHostLiteral=function(e){for(var t=new $(e);!t.isEmpty();){var n=t.head();ve(n)||58===n?this.builder.append(n):this.writeEncoded(n),t.step()}},Xe.prototype.writePort=function(e){for(var t=9,n=new Array(10);e>0;)n[t]=e%10,e=Math.floor(e/10),t-=1;for(t+=1;t<10;)this.builder.append(48+n[t]),t+=1},Xe.prototype.writePath=function(e){"string"==typeof e&&(e=Ne(e));for(var t=0,n=e.length;t<n;t+=1){var i=e[t];"/"===i?this.builder.append(47):this.writePathSegment(i)}},Xe.prototype.writePathSegment=function(e){for(var t=new $(e);!t.isEmpty();){var n=t.head();me(n)?this.builder.append(n):this.writeEncoded(n),t.step()}},Xe.prototype.writeQuery=function(e){"string"==typeof e?this.writeQueryPart(e):Array.isArray(e)?this.writeQueryArray(e):e&&this.writeQueryParams(e)},Xe.prototype.writeQueryArray=function(e){for(var t=0,n=e.length;t<n;t+=1){var i=e[t];"string"==typeof i?(t>0&&this.builder.append(38),this.writeQueryParam(i)):this.writeQueryParams(i,t)}},Xe.prototype.writeQueryParams=function(e,t){for(var n=Object.keys(e),i=0,r=n.length;i<r;t+=1,i+=1){var o=n[i],s=e[o];t>0&&this.builder.append(38),this.writeQueryParam(o),this.builder.append(61),this.writeQueryParam(s)}},Xe.prototype.writeQueryParam=function(e){for(var t=new $(e);!t.isEmpty();){var n=t.head();ge(n)?this.builder.append(n):this.writeEncoded(n),t.step()}},Xe.prototype.writeQueryPart=function(e){for(var t=new $(e);!t.isEmpty();){var n=t.head();be(n)?this.builder.append(n):this.writeEncoded(n),t.step()}},Xe.prototype.writeFragment=function(e){for(var t=new $(e);!t.isEmpty();){var n=t.head();we(n)?this.builder.append(n):this.writeEncoded(n),t.step()}},Xe.prototype.writeEncoded=function(e){0===e?(this.writePctEncoded(192),this.writePctEncoded(128)):e>=0&&e<=127?this.writePctEncoded(e):e>=128&&e<=2047?(this.writePctEncoded(192|e>>>6),this.writePctEncoded(128|63&e)):e>=2048&&e<=65535||e>=57344&&e<=65535?(this.writePctEncoded(224|e>>>12),this.writePctEncoded(128|e>>>6&63),this.writePctEncoded(128|63&e)):e>=65536&&e<=1114111?(this.writePctEncoded(240|e>>>18),this.writePctEncoded(128|e>>>12&63),this.writePctEncoded(128|e>>>6&63),this.writePctEncoded(128|63&e)):(this.writePctEncoded(239),this.writePctEncoded(191),this.writePctEncoded(189))},Xe.prototype.writePctEncoded=function(e){this.builder.append(37),this.builder.append(Ce(e>>>4&15)),this.builder.append(Ce(15&e))},Xe.prototype.state=function(){return this.builder.state()};var Ge={};Ge.parse=Le,Ge.stringify=Ve,Ge.resolve=$e,Ge.unresolve=We,e.exports=function(e){return B.apply(null,arguments)},t=e.exports,t.parse=i,t.stringify=r,t.base64=o,t.isRecord=s,t.size=c,t.head=f,t.tail=d,t.tag=y,t.has=v,t.get=m,t.set=b,t.remove=E,t.keys=D,t.values=j,t.forEach=C,t.concat=x,t.equal=P,t.compare=S,t.uri=Ge,t.config=Je,t.StringIterator=$,t.DocumentParser=Z,t.BlockParser=ee,t.RecordParser=re,t.UriParser=Pe,t.SchemeParser=Ue,t.AuthorityParser=Ae,t.PathParser=Fe,t.QueryParser=Be,t.FragmentParser=ze},function(e,t){e.exports={version:"0.3.11"}},function(e,t,n){(function(e){"use strict";function i(e){switch(D.tag(e)){case"@event":return l.decode(e);case"@command":return c.decode(e);case"@link":return f.decode(e);case"@linked":return d.decode(e);case"@sync":return y.decode(e);case"@synced":return v.decode(e);case"@unlink":return m.decode(e);case"@unlinked":return b.decode(e);case"@auth":return g.decode(e);case"@authed":return w.decode(e);case"@deauth":return E.decode(e);case"@deauthed":return k.decode(e)}}function r(e){return e.encode()}function o(e){return i(D.parse(e))}function s(e){return D.stringify(r(e))}function p(){}function a(){p.call(this)}function u(){p.call(this)}function h(){p.call(this)}function l(e,t,n){h.call(this),this.node=e,this.lane=t,this.body=n}function c(e,t,n){h.call(this),this.node=e,this.lane=t,this.body=n}function f(e,t,n,i){a.call(this),this.node=e,this.lane=t,this.prio=n||0,this.body=i}function d(e,t,n,i){u.call(this),this.node=e,this.lane=t,this.prio=n||0,this.body=i}function y(e,t,n,i){a.call(this),this.node=e,this.lane=t,this.prio=n||0,this.body=i}function v(e,t,n){u.call(this),this.node=e,this.lane=t,this.body=n}function m(e,t,n){a.call(this),this.node=e,this.lane=t,this.body=n}function b(e,t,n){u.call(this),this.node=e,this.lane=t,this.body=n}function g(e){a.call(this),this.body=e}function w(e){u.call(this),this.body=e}function E(e){a.call(this),this.body=e}function k(e){u.call(this),this.body=e}var O=n(6),D=e.recon||n(3);Object.defineProperty(p.prototype,"isRequest",{value:!1}),Object.defineProperty(p.prototype,"isResponse",{value:!1}),Object.defineProperty(p.prototype,"isMessage",{value:!1}),Object.defineProperty(p.prototype,"isEventMessage",{value:!1}),Object.defineProperty(p.prototype,"isCommandMessage",{value:!1}),Object.defineProperty(p.prototype,"isLinkRequest",{value:!1}),Object.defineProperty(p.prototype,"isLinkedResponse",{value:!1}),Object.defineProperty(p.prototype,"isSyncRequest",{value:!1}),Object.defineProperty(p.prototype,"isSyncedResponse",{value:!1}),Object.defineProperty(p.prototype,"isUnlinkRequest",{value:!1}),Object.defineProperty(p.prototype,"isUnlinkedResponse",{value:!1}),Object.defineProperty(p.prototype,"isAuthRequest",{value:!1}),Object.defineProperty(p.prototype,"isAuthedResponse",{value:!1}),Object.defineProperty(p.prototype,"isDeauthRequest",{value:!1}),Object.defineProperty(p.prototype,"isDeauthedResponse",{value:!1}),a.prototype=Object.create(p.prototype),a.prototype.constructor=a,Object.defineProperty(a.prototype,"isRequest",{value:!0}),u.prototype=Object.create(p.prototype),u.prototype.constructor=u,Object.defineProperty(u.prototype,"isResponse",{value:!0}),h.prototype=Object.create(p.prototype),h.prototype.constructor=h,Object.defineProperty(h.prototype,"isMessage",{value:!0}),l.prototype=Object.create(h.prototype),l.prototype.constructor=l,Object.defineProperty(l.prototype,"isEventMessage",{value:!0}),l.prototype.withAddress=function(e,t){return void 0===e&&(e=this.node),void 0===t&&(t=this.lane),new l(e,t,this.body)},l.prototype.encode=function(){var e=[{node:this.node},{lane:this.lane}];return D.concat({"@event":e},this.body)},l.decode=function(e){for(var t,n,i=D.tail(e),r=D.head(e),o=r&&r.length||0,s=0;s<o;s+=1){var p=r[s];void 0!==p.node?t=p.node:void 0!==p.lane?n=p.lane:0===s?t=p:1===s&&(n=p)}if(void 0!==t&&void 0!==n)return new l(t,n,i)},c.prototype=Object.create(h.prototype),c.prototype.constructor=c,Object.defineProperty(c.prototype,"isCommandMessage",{value:!0}),c.prototype.withAddress=function(e,t){return void 0===e&&(e=this.node),void 0===t&&(t=this.lane),new c(e,t,this.body)},c.prototype.encode=function(){var e=[{node:this.node},{lane:this.lane}];return D.concat({"@command":e},this.body)},c.decode=function(e){for(var t,n,i=D.tail(e),r=D.head(e),o=r&&r.length||0,s=0;s<o;s+=1){var p=r[s];void 0!==p.node?t=p.node:void 0!==p.lane?n=p.lane:0===s?t=p:1===s&&(n=p)}if(void 0!==t&&void 0!==n)return new c(t,n,i)},f.prototype=Object.create(a.prototype),f.prototype.constructor=f,Object.defineProperty(f.prototype,"isLinkRequest",{value:!0}),f.prototype.withAddress=function(e,t){return void 0===e&&(e=this.node),void 0===t&&(t=this.lane),new f(e,t,this.prio,this.body)},f.prototype.encode=function(){var e=[{node:this.node},{lane:this.lane}];return this.prio&&e.push({prio:this.prio}),D.concat({"@link":e},this.body)},f.decode=function(e){for(var t,n,i,r=D.tail(e),o=D.head(e),s=o&&o.length||0,p=0;p<s;p+=1){var a=o[p];void 0!==a.node?t=a.node:void 0!==a.lane?n=a.lane:void 0!==a.prio?i=a.prio:0===p?t=a:1===p&&(n=a)}if(void 0!==t&&void 0!==n)return new f(t,n,i,r)},d.prototype=Object.create(u.prototype),d.prototype.constructor=d,Object.defineProperty(d.prototype,"isLinkedResponse",{
value:!0}),d.prototype.withAddress=function(e,t){return void 0===e&&(e=this.node),void 0===t&&(t=this.lane),new d(e,t,this.prio,this.body)},d.prototype.encode=function(){var e=[{node:this.node},{lane:this.lane}];return this.prio&&e.push({prio:this.prio}),D.concat({"@linked":e},this.body)},d.decode=function(e){for(var t,n,i,r=D.tail(e),o=D.head(e),s=o&&o.length||0,p=0;p<s;p+=1){var a=o[p];void 0!==a.node?t=a.node:void 0!==a.lane?n=a.lane:void 0!==a.prio?i=a.prio:0===p?t=a:1===p&&(n=a)}if(void 0!==t&&void 0!==n)return new d(t,n,i,r)},y.prototype=Object.create(a.prototype),y.prototype.constructor=y,Object.defineProperty(y.prototype,"isSyncRequest",{value:!0}),y.prototype.withAddress=function(e,t){return void 0===e&&(e=this.node),void 0===t&&(t=this.lane),new y(e,t,this.prio,this.body)},y.prototype.encode=function(){var e=[{node:this.node},{lane:this.lane}];return this.prio&&e.push({prio:this.prio}),D.concat({"@sync":e},this.body)},y.decode=function(e){for(var t,n,i,r=D.tail(e),o=D.head(e),s=o&&o.length||0,p=0;p<s;p+=1){var a=o[p];void 0!==a.node?t=a.node:void 0!==a.lane?n=a.lane:void 0!==a.prio?i=a.prio:0===p?t=a:1===p&&(n=a)}if(void 0!==t&&void 0!==n)return new y(t,n,i,r)},v.prototype=Object.create(u.prototype),v.prototype.constructor=v,Object.defineProperty(v.prototype,"isSyncedResponse",{value:!0}),v.prototype.withAddress=function(e,t){return void 0===e&&(e=this.node),void 0===t&&(t=this.lane),new v(e,t,this.body)},v.prototype.encode=function(){var e=[{node:this.node},{lane:this.lane}];return D.concat({"@synced":e},this.body)},v.decode=function(e){for(var t,n,i=D.tail(e),r=D.head(e),o=r&&r.length||0,s=0;s<o;s+=1){var p=r[s];void 0!==p.node?t=p.node:void 0!==p.lane?n=p.lane:0===s?t=p:1===s&&(n=p)}if(void 0!==t&&void 0!==n)return new v(t,n,i)},m.prototype=Object.create(a.prototype),m.prototype.constructor=m,Object.defineProperty(m.prototype,"isUnlinkRequest",{value:!0}),m.prototype.withAddress=function(e,t){return void 0===e&&(e=this.node),void 0===t&&(t=this.lane),new m(e,t,this.body)},m.prototype.encode=function(){var e=[{node:this.node},{lane:this.lane}];return D.concat({"@unlink":e},this.body)},m.decode=function(e){for(var t,n,i=D.tail(e),r=D.head(e),o=r&&r.length||0,s=0;s<o;s+=1){var p=r[s];void 0!==p.node?t=p.node:void 0!==p.lane?n=p.lane:0===s?t=p:1===s&&(n=p)}if(void 0!==t&&void 0!==n)return new m(t,n,i)},b.prototype=Object.create(u.prototype),b.prototype.constructor=b,Object.defineProperty(b.prototype,"isUnlinkedResponse",{value:!0}),b.prototype.withAddress=function(e,t){return void 0===e&&(e=this.node),void 0===t&&(t=this.lane),new b(e,t,this.body)},b.prototype.encode=function(){var e=[{node:this.node},{lane:this.lane}];return D.concat({"@unlinked":e},this.body)},b.decode=function(e){for(var t,n,i=D.tail(e),r=D.head(e),o=r&&r.length||0,s=0;s<o;s+=1){var p=r[s];void 0!==p.node?t=p.node:void 0!==p.lane?n=p.lane:0===s?t=p:1===s&&(n=p)}if(void 0!==t&&void 0!==n)return new b(t,n,i)},g.prototype=Object.create(a.prototype),g.prototype.constructor=g,Object.defineProperty(g.prototype,"isAuthRequest",{value:!0}),g.prototype.encode=function(){return D.concat({"@auth":null},this.body)},g.decode=function(e){var t=D.tail(e);return new g(t)},w.prototype=Object.create(u.prototype),w.prototype.constructor=w,Object.defineProperty(w.prototype,"isAuthedResponse",{value:!0}),w.prototype.encode=function(){return D.concat({"@authed":null},this.body)},w.decode=function(e){var t=D.tail(e);return new w(t)},E.prototype=Object.create(a.prototype),E.prototype.constructor=E,Object.defineProperty(E.prototype,"isDeauthRequest",{value:!0}),E.prototype.encode=function(){return D.concat({"@deauth":null},this.body)},E.decode=function(e){var t=D.tail(e);return new E(t)},k.prototype=Object.create(u.prototype),k.prototype.constructor=k,Object.defineProperty(k.prototype,"isDeauthedResponse",{value:!0}),k.prototype.encode=function(){return D.concat({"@deauthed":null},this.body)},k.decode=function(e){var t=D.tail(e);return new k(t)},t.decode=i,t.encode=r,t.parse=o,t.stringify=s,t.Envelope=p,t.RequestEnvelope=a,t.ResponseEnvelope=u,t.MessageEnvelope=h,t.EventMessage=l,t.CommandMessage=c,t.SyncRequest=y,t.SyncedResponse=v,t.LinkRequest=f,t.LinkedResponse=d,t.UnlinkRequest=m,t.UnlinkedResponse=b,t.AuthRequest=g,t.AuthedResponse=w,t.DeauthRequest=E,t.DeauthedResponse=k,t.config=O}).call(t,function(){return this}())},function(e,t){e.exports={version:"0.4.2"}},function(e,t,n){function i(e,t){var n;return n=t?new o(e,t):new o(e)}var r=function(){return this}(),o=r.WebSocket||r.MozWebSocket,s=n(8);e.exports={w3cwebsocket:o?i:null,version:s}},function(e,t,n){e.exports=n(9).version},function(e,t){e.exports={_args:[[{raw:"websocket@^1.0.23",scope:null,escapedName:"websocket",name:"websocket",rawSpec:"^1.0.23",spec:">=1.0.23 <2.0.0",type:"range"},"/home/derek/Projects/swim-dev-tools/node_modules/swim-client-js"]],_from:"websocket@>=1.0.23 <2.0.0",_id:"websocket@1.0.24",_inCache:!0,_location:"/websocket",_nodeVersion:"7.3.0",_npmOperationalInternal:{host:"packages-12-west.internal.npmjs.com",tmp:"tmp/websocket-1.0.24.tgz_1482977757939_0.1858439394272864"},_npmUser:{name:"theturtle32",email:"brian@worlize.com"},_npmVersion:"3.10.10",_phantomChildren:{},_requested:{raw:"websocket@^1.0.23",scope:null,escapedName:"websocket",name:"websocket",rawSpec:"^1.0.23",spec:">=1.0.23 <2.0.0",type:"range"},_requiredBy:["/swim-client-js"],_resolved:"https://registry.npmjs.org/websocket/-/websocket-1.0.24.tgz",_shasum:"74903e75f2545b6b2e1de1425bc1c905917a1890",_shrinkwrap:null,_spec:"websocket@^1.0.23",_where:"/home/derek/Projects/swim-dev-tools/node_modules/swim-client-js",author:{name:"Brian McKelvey",email:"brian@worlize.com",url:"https://www.worlize.com/"},browser:"lib/browser.js",bugs:{url:"https://github.com/theturtle32/WebSocket-Node/issues"},config:{verbose:!1},contributors:[{name:"Iaki Baz Castillo",email:"ibc@aliax.net",url:"http://dev.sipdoc.net"}],dependencies:{debug:"^2.2.0",nan:"^2.3.3","typedarray-to-buffer":"^3.1.2",yaeti:"^0.0.6"},description:"Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.",devDependencies:{"buffer-equal":"^1.0.0",faucet:"^0.0.1",gulp:"git+https://github.com/gulpjs/gulp.git#4.0","gulp-jshint":"^2.0.4",jshint:"^2.0.0","jshint-stylish":"^2.2.1",tape:"^4.0.1"},directories:{lib:"./lib"},dist:{shasum:"74903e75f2545b6b2e1de1425bc1c905917a1890",tarball:"https://registry.npmjs.org/websocket/-/websocket-1.0.24.tgz"},engines:{node:">=0.8.0"},gitHead:"0e15f9445953927c39ce84a232cb7dd6e3adf12e",homepage:"https://github.com/theturtle32/WebSocket-Node",keywords:["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],license:"Apache-2.0",main:"index",maintainers:[{name:"theturtle32",email:"brian@worlize.com"}],name:"websocket",optionalDependencies:{},readme:"ERROR: No README data found!",repository:{type:"git",url:"git+https://github.com/theturtle32/WebSocket-Node.git"},scripts:{gulp:"gulp",install:"(node-gyp rebuild 2> builderror.log) || (exit 0)",test:"faucet test/unit"},version:"1.0.24"}},function(e,t,n){function i(e,t,n){for(var o=new h(t,n,i),s=0;s<e.length&&!r(e[s],o);s++);if(r(null,o),o.currentItem instanceof Object)o.addReference(o.currentItem);else{var p=u(o.currentParents);p&&o.addReference(p)}return{value:o.currentItem,key:o.currentKey,references:o.currentReferences,parents:o.currentParents}}function r(e,t){if(null==e)!t.currentItem&&t.options.force&&t.force(t.options.force);else if(e.values)if(t.currentItem){var n=Object.keys(t.currentItem),i=[];n.forEach(function(n){e.deep&&Array.isArray(t.currentItem[n])?t.currentItem[n].forEach(function(e){i.push(e)}):i.push(t.currentItem[n])}),t.setCurrent(n,i)}else t.setCurrent(n,[]);else if(e.get){var r=t.getValue(e.get);if(p(t,r))t.setCurrent(r,t.override[r]);else if(t.currentItem||t.options.force&&t.force({}))if(a(t.currentItem,r)||e.multiple){var i=t.currentItem.map(function(e){return e[r]}).filter(s);i=Array.prototype.concat.apply([],i),t.setCurrent(r,i)}else t.setCurrent(r,t.currentItem[r]);else t.setCurrent(r,null)}else if(e.select)if(Array.isArray(t.currentItem)||t.options.force&&t.force([])){var u=(e.boolean?e.select:[e]).map(function(e){if(":"===e.op){var n=t.getValue(e.select[0]);return{func:function(i){return n&&(i=i[n]),t.getValueFrom(e.select[1],i)},negate:e.negate,booleanOp:e.booleanOp}}var i=t.getValues(e.select);if(!t.options.allowRegexp&&"~"===e.op&&i[1]instanceof RegExp)throw new Error("options.allowRegexp is not enabled.");return{key:i[0],value:i[1],negate:e.negate,booleanOp:e.booleanOp,op:e.op}});if(e.multiple){var n=[],h=[];t.currentItem.forEach(function(e,t){o(e,u)&&(n.push(t),h.push(e))}),t.setCurrent(n,h)}else t.currentItem.some(function(e,n){if(o(e,u))return t.setCurrent(n,e),!0})||t.setCurrent(null,null)}else t.setCurrent(null,null);else if(e.root)t.resetCurrent(),e.args&&e.args.length?t.setCurrent(null,t.getValue(e.args[0])):t.setCurrent(null,t.rootContext);else if(e.parent)t.resetCurrent(),t.setCurrent(null,t.options.parent);else if(e.or){if(t.currentItem)return!0;t.resetCurrent(),t.setCurrent(null,t.context)}else if(e.filter){var l=t.getLocal(e.filter)||t.getGlobal(e.filter);if("function"==typeof l){var i=t.getValues(e.args||[]),c=l.apply(t.options,[t.currentItem].concat(i));t.setCurrent(null,c)}else{var f=t.getFilter(e.filter);if("function"==typeof f){var i=t.getValues(e.args||[]),c=f.call(t.options,t.currentItem,{args:i,state:t,data:t.rootContext});t.setCurrent(null,c)}}}else if(e.deep)if(t.currentItem){if(0===e.deep.length)return;var c=t.deepQuery(t.currentItem,e.deep,t.options);if(c){t.setCurrent(c.key,c.value);for(var d=0;d<c.parents.length;d++)t.currentParents.push(c.parents[d])}else t.setCurrent(null,null)}else t.currentItem=null}function o(e,t){for(var n=!1,i=0;i<t.length;i++){var r=t[i],o=!1;r.func?o=r.func(e):"~"===r.op?o=r.value instanceof RegExp?e[r.key]&&!!e[r.key].match(r.value):e[r.key]&&!!~e[r.key].indexOf(r.value):"="===r.op?o=e[r.key]===!0&&"true"===r.value||e[r.key]===!1&&"false"===r.value||e[r.key]==r.value:">"===r.op?o=e[r.key]>r.value:"<"===r.op?o=e[r.key]<r.value:">="===r.op?o=e[r.key]>=r.value:"<="===r.op&&(o=e[r.key]<=r.value),r.negate&&(o=!o),n="&"===r.booleanOp?n&&o:"|"===r.booleanOp?n||o:o}return n}function s(e){return"undefined"!=typeof e}function p(e,t){return e.override&&e.currentItem===e.rootContext&&void 0!==e.override[t]}function a(e,t){return e instanceof Array&&parseInt(t)!=t}function u(e){for(var t=0;t<e.length;t++)if(!(e[t+1]&&e[t+1].value instanceof Object))return e[t].value}var h=n(11),l=n(12),c={};e.exports=function(e,t){var n=t&&t.params||null;return Array.isArray(e)&&(n=e.slice(1),e=e[0]),c[e]||(c[e]=l(e,!0)),i(c[e],t,n)},e.exports.lastParent=function(e){var t=e.parents[e.parents.length-1];return t?t.value:null}},function(e,t){function n(e,t,n){e=e||{},this.handleQuery=n,this.options=e,this.locals=this.options.locals||{},this.globals=this.options.globals||{},this.rootContext=i(e.data,e.rootContext,e.context,e.source),this.parent=e.parent,this.override=e.override,this.filters=e.filters||{},this.params=t||e.params||[],this.context=i(e.currentItem,e.context,e.source),this.currentItem=i(this.context,e.rootContext,e.data),this.currentKey=null,this.currentReferences=[],this.currentParents=[]}function i(e){for(var t=0;t<arguments.length;t++)if(null!=arguments[t])return arguments[t]}function r(e){var t={};if(e)for(var n in e)n in e&&(t[n]=e[n]);return t}e.exports=n,n.prototype={setCurrent:function(e,t){(this.currentItem||this.currentKey||this.currentParents.length>0)&&this.currentParents.push({key:this.currentKey,value:this.currentItem}),this.currentItem=t,this.currentKey=e},resetCurrent:function(){this.currentItem=null,this.currentKey=null,this.currentParents=[]},force:function(e){var t=this.currentParents[this.currentParents.length-1];return!this.currentItem&&t&&null!=this.currentKey&&(this.currentItem=e||{},t.value[this.currentKey]=this.currentItem),!!this.currentItem},getLocal:function(e){if(~e.indexOf("/")){for(var t=null,n=e.split("/"),i=0;i<n.length;i++){var r=n[i];0==i?t=this.locals[r]:t&&t[r]&&(t=t[r])}return t}return this.locals[e]},getGlobal:function(e){if(~e.indexOf("/")){for(var t=null,n=e.split("/"),i=0;i<n.length;i++){var r=n[i];0==i?t=this.globals[r]:t&&t[r]&&(t=t[r])}return t}return this.globals[e]},getFilter:function(e){if(~e.indexOf("/")){for(var t=null,n=e.split("/"),i=0;i<n.length;i++){var r=n[i];0==i?t=this.filters[r]:t&&t[r]&&(t=t[r])}return t}return this.filters[e]},addReferences:function(e){e&&e.forEach(this.addReference,this)},addReference:function(e){e instanceof Object&&!~this.currentReferences.indexOf(e)&&this.currentReferences.push(e)},getValues:function(e,t){return e.map(this.getValue,this)},getValue:function(e){return this.getValueFrom(e,null)},getValueFrom:function(e,t){if(null!=e._param)return this.params[e._param];if(e._sub){var n=r(this.options);n.force=null,n.currentItem=t;var i=this.handleQuery(e._sub,n,this.params);return this.addReferences(i.references),i.value}return e},deepQuery:function(e,t,n,i){Object.keys(e);for(var o in e)if(o in e){var n=r(this.options);n.currentItem=e[o];var s=this.handleQuery(t,n,this.params);if(s.value)return s}return null}}},function(e,t,n){function i(e){return","===e?[","]:h(e,/,/).map(function(e){return p(e.trim())})}function r(e){if("*"===e)return{values:!0};if("**"===e)return{values:!0,deep:!0};var t=!1;"*"===e.charAt(0)&&(t=!0,e=e.slice(1));var n=h(e,/&|\|/,{includeDelimiters:!0});if(n.length>1){for(var i=[o(n[0].trim())],r=1;r<n.length;r+=2){var s=o(n[r+1].trim());s&&(s.booleanOp=n[r],i.push(s))}return{multiple:t,boolean:!0,select:i}}var i=o(e.trim());return i?(t&&(i.multiple=!0),i):{get:p(e.trim())}}function o(t){var n=h(t,/(!)?(=|~|\:|<=|>=|<|>)/,{max:2,includeDelimiters:!0});if(3===n.length){var i="!"===n[1].charAt(0),r=p(n[0].trim()),o={negate:i,op:i?n[1].slice(1):n[1]};if(":"===o.op)o.select=[r,{_sub:e.exports(":"+n[2].trim())}];else if("~"===o.op){var s=p(n[2].trim());if("string"==typeof s){var a=n[2].trim().match(/^\/(.*)\/([a-z]?)$/);a?o.select=[r,new RegExp(a[1],a[2])]:o.select=[r,s]}else o.select=[r,s]}else o.select=[r,p(n[2].trim())];return o}}function s(e){return"{"===e.charAt(0)&&"}"===e.charAt(e.length-1)}function p(t){if(s(t)){var n=t.slice(1,-1);return{_sub:e.exports(n)}}return a(t)}function a(e){if("?"===e.charAt(0)){var t=parseInt(e.slice(1));return isNaN(t)?e:{_param:t}}return e}function u(e){var t=0;return e.replace(/\?/g,function(e){return e+t++})}var h=n(13);e.exports=function(e,t){function n(e){m?m.push(e):a.push(e)}function o(){var t=e.slice(l,c);g[v]&&g[v](t),v="get",l=c+1}if(!e)return[];var s,p,a=[],h=e.charAt(0),l=0,c=0,f=0,d=0,y=0,v="get",m=null;t&&(e=u(e));for(var b={".":{mode:"get"},":":{mode:"filter"},"|":{handle:"or"},"[":{open:"select"},"]":{close:"select"},"{":{open:"meta"},"}":{close:"meta"},"(":{open:"args"},")":{close:"args"}},g={get:function(e){var t="string"==typeof e?e.trim():null;t&&n({get:t})},select:function(e){if(e)n(r(e));else{var t={deep:[]};a.push(t),m=t.deep}},filter:function(e){e&&n({filter:e.trim()})},or:function(){m=null,a.push({or:!0}),f=w+1},args:function(e){var t=i(e);a[a.length-1].args=t}},w=0;w<e.length;w++){s=p,p=h,h=e.charAt(w+1),d=w-f,0===d&&":"!==p&&"."!==p&&a.push({root:!0}),0===d&&"."===p&&"."===h&&a.push({parent:!0});var E=b[p];E&&(0===y&&(E.mode||E.open)&&(o(),v=E.mode||E.open),0===y&&E.handle&&(o(),g[E.handle]()),E.open?y+=1:E.close&&(y-=1),0===y&&E.close&&o()),c=w+1}return o(),a}},function(e,t){function n(e,t,n){var i=n&&n.max||1/0,r=n&&n.includeDelimiters||!1,o=0,s=0,p=[],a=[];e.replace(/([\[\(\{])|([\]\)\}])/g,function(e,t,n,i){t?(0===o&&a.push([s,i]),o+=1):n&&(o-=1,0===o&&(s=i+e.length))}),0===o&&s<e.length&&a.push([s,e.length]),s=0;for(var u=0;u<a.length&&i>0;u++)for(var h=a[u][0],l=t.exec(e.slice(h,a[u][1]));l&&i>1;h+=l.index+l[0].length,s=h,l=t.exec(e.slice(h,a[u][1])))p.push(e.slice(s,l.index+h)),r&&p.push(l[0]),i-=1;return s<e.length&&p.push(e.slice(s)),p}e.exports=n}]);